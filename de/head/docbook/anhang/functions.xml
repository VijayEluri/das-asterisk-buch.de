<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE appendix PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<appendix id="functions" lang="de" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

  <title>Funktionen im Dialplan</title>

  <indexterm>
    <primary>Funktionen</primary>

    <secondary>Dialplan</secondary>
  </indexterm>

  <simpara>Seit Asterisk 1.2 gibt es im Dialplan nicht nur Applikationen,
  sondern auch sogenannte Funktionen. Anders als Applikationen können
  Funktionen nicht direkt aufgerufen werden. Stattdessen geben sie einen Wert
  zurück oder - was dem klassischen Verständnis einer Funktion widerspricht -
  man kann auch (oder nur), in Verbindung mit der Applikation
  <code>Set()</code> (siehe <xref linkend="applications-set" />), schreibend
  auf sie zugreifen. Funktionsnamen werden immer ganz in Großbuchstaben
  geschrieben. Funktionen werden erstaunlicherweise wie Variablen durchwegs in
  <code>${}</code> eingeklammert, was notwendig ist, da Strings nicht immer in
  Hochkommata stehen müssen.</simpara>

  <sidebar>
    <para>Würde man die in Asterisk nicht unbedingt intuitive Trennung
    zwischen Applikationen, Funktionen und sogar Variablen kritisieren, hätte
    man damit wahrscheinlich nicht ganz unrecht. Auch die Benennung ist nicht
    einheitlich: <code>SIP_HEADER()</code>, aber <code>SIPCHANINFO()</code> -
    ein Problem vieler Programmiersprachen, das letztlich nichts aussagt, aber
    die Einprägsamkeit erschwert. Die Idee, in Funktionen zu
    <emphasis>schreiben</emphasis>, ist recht ungewöhnlich und weicht vom
    üblichen Verständnis einer Funktion ab. Eine <quote>Funktion</quote> in
    Asterisk kann man sich eher vorstellen wie ein assoziatives Array<footnote>
        <para><ulink
        url="http://de.wikipedia.org/wiki/Assoziatives_Array">http://de.wikipedia.org/wiki/Assoziatives_Array</ulink></para>
      </footnote> (auch Hash-Tabelle genannt) in anderen Programmiersprachen.
    Beispiel:<programlisting>Set(CHANNEL(language)=de);
NoOp(Sprache: ${CHANNEL(language)});</programlisting>würde in PHP so
    aussehen:<programlisting>$channel["language"] = "de";
echo "Sprache: ", $channel["language"];</programlisting></para>

    <para>Bei vielen Funktionen kann der Schlüssel in dem (gedachten)
    assoziativen Array allerdings auch leer sein. Beispiel:<programlisting>Set(GROUP()=ausgehend);</programlisting></para>

    <para>Insgesamt wirkt die Dialplan-Programmierung - trotz der Neuerungen
    in Version 1.4 - im Vergleich zu <quote>richtigen</quote>
    Programmiersprachen sehr starr und wenig erweiterungsfähig. Wen das stört,
    der sollte sich vielleicht mit der - AEL (Asterisk Extension Language)
    befassen, die die gleichen Funktionen und Applikationen verwendet, aber
    eine etwas robustere Struktur bietet und oft übersichtlicher ist.</para>
  </sidebar>

  <simpara>Im Asterisk-CLI<footnote>
      <para>Command Line Interface, kann durch <command>asterisk -r</command>
      aufgerufen werden</para>
    </footnote> können Sie mit <userinput>core show functions</userinput> und
  <userinput>core show function
  <replaceable>Funktionsname</replaceable></userinput> herausfinden, welche
  Funktionen in Ihrer Installation verfügbar sind. Dabei ist die komplette
  Großschreibung des Funktionsnamens wichtig.</simpara>

  <xi:include href="functions/agc.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/agent.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/array.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/ast_config.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/base64_decode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/base64_encode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/blacklist.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/callerid.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/callerpres.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/cdr.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/channel.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/channels.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/check_md5.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/checksipdomain.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/curl.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/cut.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/db.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/db_delete.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/db_exists.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/denoise.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/device_state.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/dialgroup.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/dialplan_exists.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/dundilookup.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/dundiquery.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/dundiresult.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/enumlookup.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/enumquery.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/enumresult.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/env.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/eval.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/exception.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/exists.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/extension_state.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/fieldqty.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/file.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/filter.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/global.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group_list.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group_match_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/hash.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/hashkeys.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/hint.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/iaxpeer.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/iaxvar.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/iconv.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/if.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/ifmodule.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/iftime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/import.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/isnull.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/jabber_status.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/keypadhash.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/language.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/len.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/local.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/lock.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/mailbox_exists.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/math.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/md5.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/meetme_info.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/minivmaccount.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/minivmcounter.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/musicclass.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_antigf.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_fetch.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_function.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_presence.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_sql.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_user_database.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <!--
  <xi:include href="functions/pp_each_extension.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/pp_each_user.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />
  -->

  <xi:include href="functions/queue_member.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_member_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_member_list.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_member_penalty.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_variables.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_waiting_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queueagentcount.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/quote.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/rand.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/realtime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/realtime_destroy.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/realtime_store.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/regex.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/set.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sha1.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/shared.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/shell.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sip_header.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sipchaninfo.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sippeer.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/smdi_msg.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/smdi_msg_retrieve.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sort.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <!--
  <xi:include href="functions/speech.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/speech_engine.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/speech_grammar.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/speech_results_type.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/speech_score.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/speech_text.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />
  -->

  <xi:include href="functions/sprintf.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sql_esc.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/stat.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/strftime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/strptime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sysinfo.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/timeout.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/tolower.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/toupper.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/trylock.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/txtcidname.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/unlock.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/uridecode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/uriencode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/valid_exten.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/version.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/vmcount.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/volume.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />
</appendix>
