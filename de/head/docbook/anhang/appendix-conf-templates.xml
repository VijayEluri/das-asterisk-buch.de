<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE appendix PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<appendix id="anhang-conf-templates">
  <title>Konfigurations-Templates<indexterm>
      <primary>config templates</primary>
    </indexterm><indexterm>
      <primary>Konfigurations-Templates</primary>
    </indexterm></title>

  <simpara>Konfigurationsdateien wie die <filename>sip.conf</filename>,
  <filename>iax.conf</filename> etc. haben oft viele ähnliche Einträge und
  sind dadurch schlecht wartbar.</simpara>

  <para>Das könnte in einer normalen <filename>sip.conf</filename>
  stehen:<programlisting>[201]
username=201
secret=1111
context=default
type=friend
qualify=yes
host=dynamic
canreinvite=no

[202]
username=202
secret=2222
context=default
type=friend
qualify=yes
host=dynamic
canreinvite=no

[203]
username=203
secret=3333
context=default
type=friend
qualify=yes
host=dynamic
canreinvite=no</programlisting></para>

  <para>Asterisk bietet aber die kaum bekannte Möglichkeit, hierfür
  <emphasis>Templates</emphasis> (Vorlagen) zu verwenden. Mit einem Template
  für unsere Telefone sähe das so aus:<programlisting>[meine-telefone]<emphasis
        role="bold">(!)</emphasis>     ; dieser Abschnitt ist das Template
context=default
type=friend
qualify=yes
host=dynamic
canreinvite=no

[201]<emphasis role="bold">(meine-telefone)</emphasis>   ; Telefon 201
username=201
secret=1111

[202]<emphasis role="bold">(meine-telefone)</emphasis>   ; Telefon 202
username=202
secret=2222

[203]<emphasis role="bold">(meine-telefone)</emphasis>   ; Telefon 203
username=203
secret=3333</programlisting></para>

  <para>Hier erben die Abschnitte <code>201</code>, <code>202</code> und
  <code>203</code> alle im Abschnitt (dem Template)
  <code>meine-telefone</code> gesetzten Werte.</para>

  <simpara>Das ist besonders interssant, wenn man verschiedene Gruppen oder
  Klassen von sehr ähnlichen Einträgen hat, also wenn nicht die Möglichkeit
  besteht, einfach alle Gemeinsamkeiten in den Abschnitt
  <code>[general]</code> zu schreiben. Schon in diesem einfachen Beispiel
  haben wir uns ein paar Zeilen gespart und können vor allem Veränderungen für
  alle Telefone der <quote>Klasse</quote> <code>meine-telefone</code> an
  zentraler Stelle vornehmen.</simpara>

  <section id="conf-templates-anlegen">
    <title>Templates anlegen</title>

    <para>Prinzipiell kann jeder Abschnitt als Template für andere dienen,
    aber mit der Markierung <quote><code>(!)</code></quote> zeigt man dem
    Parser an, dass dieser Abschnitt <emphasis>ausschließlich</emphasis> als
    Template dient und selbst nicht benutzt wird. Wichtig ist, dass zwischen
    den eckigen und runden Klammern keine Leerzeichen stehen. Templates können
    auch selbst wieder auf Templates basieren.<programlisting>[meine-beispiel-template]<emphasis
          role="bold">(!)</emphasis>
context=default
type=friend
qualify=yes
host=dynamic
canreinvite=no</programlisting></para>
  </section>

  <section id="conf-templates-verwenden">
    <title>Templates verwenden</title>

    <para>Templates verwendet man durch Angabe von
    <code>(<replaceable>Templatename</replaceable>)</code> direkt &#8211; ohne
    Leerzeichen &#8211; hinter dem Abschnittsbeginn. Dadurch wird zuerst das
    angegebene Template eingebunden und dann die weiteren Parameter im
    Abschnitt ausgewertet. Abschnitte können sogar von mehreren Templates
    erben, z. B. so:<programlisting>[201]<emphasis role="bold">(meine-telefone,verkauf)</emphasis>
username=201
secret=1111</programlisting></para>

    <para>Hier erbt der Abschnitt <code>201</code> von den Templates
    <code>meine-telefone</code> und <code>verkauf</code>.</para>

    <para>Bei Bedarf kann man pro Abschnitt die Einstellungen aus dem Template
    überschreiben.</para>

    <section id="conf-templates-beispiel">
      <title>Beispiel</title>

      <para><programlisting>[telefone](!)          ; Template "telefone"
type=friend
qualify=yes
dtmfmode=rfc2833
disallow=all
allow=alaw

[snom](!,telefone)     ; Template "snom", erbt von "telefone"
dtmfmode=inband

[linksys](!,telefone)  ; Template "linksys", erbt von "telefone"
qualify=no

[snom1](snom)          ; Abschnitt "snom1", erbt von "snom"
username=101
secret=123

[snom2](snom)          ; Abschnitt "snom2", erbt von "snom"
username=102
secret=123

[linksys1](linksys)    ; Abschnitt "linksys1", erbt von "linksys"
username=103
secret=123</programlisting></para>
    </section>
  </section>
</appendix>
