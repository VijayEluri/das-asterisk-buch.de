<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="functions-cdr" lang="de" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>CDR()</literal><indexterm significance="preferred">
        <primary>Dialplan-Funktionen</primary>

        <secondary><code>CDR()</code></secondary>
      </indexterm></title>

    <synopsis>CDR(<replaceable>Feld</replaceable>)</synopsis>

    <para>Liest oder setzt CDR<footnote>
        <simpara>Call Data Record, siehe <xref
        linkend="glossar-cdr" /></simpara>
      </footnote>-Felder. <code>Feld</code> ist eines der folgenden (wenn
    nicht anders angegeben ist nur Lesen möglich):<variablelist
        termlength="13">
        <varlistentry>
          <term><code>clid</code></term>

          <listitem>
            <simpara>Caller-ID</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>src</code></term>

          <listitem>
            <simpara>Source, die Caller-ID-Nummer</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>dst</code></term>

          <listitem>
            <simpara>Destination, Ziel-Extension</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>dcontext</code></term>

          <listitem>
            <simpara>Destination context, der Ziel-Context</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>channel</code></term>

          <listitem>
            <simpara>Der Kanalname</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>dstchannel</code></term>

          <listitem>
            <simpara>Destination channel, der Ziel-Kanal, falls
            zutreffend</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>lastapp</code></term>

          <listitem>
            <simpara>Die letzte ausgeführte Applikation</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>lastdata</code></term>

          <listitem>
            <simpara>Die Argumente der zuletzt ausgeführten
            Applikation</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>start</code></term>

          <listitem>
            <simpara>Die Start-Zeit des Anrufs</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>answer</code></term>

          <listitem>
            <simpara>Die Zeit, zu der der Anruf beantwortet wurde</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>end</code></term>

          <listitem>
            <simpara>Die End-Zeit des Anrufs</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>duration</code></term>

          <listitem>
            <simpara>Die Dauer des Anrufs (in Sekunden)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>billsec</code></term>

          <listitem>
            <simpara>Die Dauer des Anrufs seit der Anruf beantwortet wurde,
            also die zu berechnende Zeit (in Sekunden)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>disposition</code></term>

          <listitem>
            <simpara>Der Status des Anrufs: <code>ANSWERED</code>, <code>NO
            ANSWER</code>, <code>BUSY</code> oder
            <code>FAILED</code></simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>amaflags</code></term>

          <listitem>
            <simpara>Die AMA<footnote>
                <simpara>Automated Message Accounting</simpara>
              </footnote>-Flags. <code>DEFAULT</code> (System-Default),
            <code>BILLING</code> (zur Abrechnung), <code>DOCUMENTATION</code>
            (zur Dokumentierung) oder <code>OMIT</code> (keine Aufzeichnung).
            (Manchmal findet man statt <code>BILLING</code> und
            <code>OMIT</code> auch die Angaben <code>BILL</code> und
            <code>IGNORE</code> - evtl. abhängig von der
            Asterisk-Version)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>accountcode</code></term>

          <listitem>
            <simpara>Die alphanumerische Nummer des Abrechnungskontos, max. 20
            Zeichen (auch Setzen möglich)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>uniqueid</code></term>

          <listitem>
            <simpara>Die einmalige alphanumerische ID des Kanals (max. 32
            Zeichen)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>userfield</code></term>

          <listitem>
            <simpara>Das User-Feld, in das beliebige Informationen (max. 255
            Zeichen) geschrieben werden können (auch Setzen möglich)</simpara>
          </listitem>
        </varlistentry>
      </variablelist><programlisting>; foo auf die Dauer des Anrufs setzen:
exten =&gt; 123,1,Set(foo=${CDR(duration)})

; das User-Feld auf "meine Infos" setzen:
exten =&gt; 123,1,Set(CDR(userfield)=meine Infos)</programlisting></para>

    <note>
      <formalpara>
        <title>Interner Hilfetext zu dieser Applikation in Asterisk
        1.4:</title>

        <para><screen>  -= Info about function 'CDR' =- 

[Syntax]
  Here is a list of all the available cdr field names:
    clid          lastdata       disposition
    src           start          amaflags
    dst           answer         accountcode
    dcontext      end            uniqueid
    dstchannel    duration       userfield
    lastapp       billsec        channel
  All of the above variables are read-only, except for accountcode,
  userfield, and amaflags. You may, however,  supply
  a name not on the above list, and create your own
  variable, whose value can be changed with this function,
  and this variable will be stored on the cdr.
   raw values for disposition:
       1 = NO ANSWER
       2 = BUSY
       3 = FAILED
       4 = ANSWERED
    raw values for amaflags:
       1 = OMIT
       2 = BILLING
       3 = DOCUMENTATION


[Synopsis]
Gets or sets a CDR variable

[Description]
Options:
  'r' searches the entire stack of CDRs on the channel
  'u' retrieves the raw, unprocessed value
  For example, 'start', 'answer', and 'end' will be retrieved as epoch
  values, when the 'u' option is passed, but formatted as YYYY-MM-DD HH:MM:SS
  otherwise.  Similarly, disposition and amaflags will return their raw
  integral values.</screen></para>
      </formalpara>

      <formalpara>
        <title>Differenz zum internen Hilfetext in Asterisk 1.2:</title>

        <para><screen>5,26c5
&lt;   Here is a list of all the available cdr field names:
&lt;     clid          lastdata       disposition
&lt;     src           start          amaflags
&lt;     dst           answer         accountcode
&lt;     dcontext      end            uniqueid
&lt;     dstchannel    duration       userfield
&lt;     lastapp       billsec        channel
&lt;   All of the above variables are read-only, except for accountcode,
&lt;   userfield, and amaflags. You may, however,  supply
&lt;   a name not on the above list, and create your own
&lt;   variable, whose value can be changed with this function,
&lt;   and this variable will be stored on the cdr.
&lt;    raw values for disposition:
&lt;        1 = NO ANSWER
&lt;        2 = BUSY
&lt;        3 = FAILED
&lt;        4 = ANSWERED
&lt;     raw values for amaflags:
&lt;        1 = OMIT
&lt;        2 = BILLING
&lt;        3 = DOCUMENTATION
&lt; 
---
&gt; CDR(&lt;name&gt;[|options])
32,38c11
&lt; Options:
&lt;   'r' searches the entire stack of CDRs on the channel
&lt;   'u' retrieves the raw, unprocessed value
&lt;   For example, 'start', 'answer', and 'end' will be retrieved as epoch
&lt;   values, when the 'u' option is passed, but formatted as YYYY-MM-DD HH:MM:SS
&lt;   otherwise.  Similarly, disposition and amaflags will return their raw
&lt;   integral values.
---
&gt; Option 'r' searches the entire stack of CDRs on the channel</screen></para>
      </formalpara>
    </note>
</section>
