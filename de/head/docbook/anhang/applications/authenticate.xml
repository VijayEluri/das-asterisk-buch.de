<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="applications-authenticate" lang="de" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

  <title><literal>Authenticate()</literal></title>

  <indexterm significance="preferred">
    <primary>Dialplan-Applikationen</primary>

    <secondary><code>Authenticate()</code></secondary>
  </indexterm>

  <simpara>Verlangt zur Fortsetzung eines Vorgangs die Eingabe eines Passworts
  vom Anrufer.</simpara>

  <synopsis>Authenticate(<replaceable>Passwort</replaceable>[,<replaceable>Optionen</replaceable>[,maxZiffern]])</synopsis>

  <simpara>Verlangt, dass der Anrufer ein gegebenes Passwort korrekt eingibt,
  um dann mit der Ausführung der nächsten Priorität im Dialplan fortzufahren.
  <code>Authenticate()</code> gibt dem Anrufer drei Versuche, das Passwort
  korrekt einzugeben. Andernfalls wird die Verbindung beendet.</simpara>

  <simpara>Falls <code>Passwort</code> mit dem <code>/</code>-Zeichen beginnt,
  wird es als Datei interpretiert, die eine Liste gültiger Passwörter (genau
  eins pro Zeile) enthält. Passwörter können auch in der Asterisk-Datenbank
  (AstDB) gespeichert sein (siehe dazu die Option <code>d</code> weiter
  unten).</simpara>

  <simpara>Folgende Optionen sind möglich (auch in Kombination):</simpara>

  <variablelist termlength="2">
    <varlistentry>
      <term><code>a</code></term>

      <listitem>
        <simpara>(accountcode) setzt den Namen des CDR-Felds
        <code>accountcode</code> und die Variable für den Channel,
        <code>ACCOUNTCODE</code>, auf das eingegebene Passwort.</simpara>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><code>d</code></term>

      <listitem>
        <simpara>(database) interpretiert <code>Passwort</code> als Schlüssel
        der Asterisk-Datenbank. Wenn ein Datenbankschlüssel benutzt wird, kann
        der mit dem Schlüssel assoziierte Wert beliebig sein.</simpara>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><code>r</code></term>

      <listitem>
        <simpara>(remove) entfernt den Datenbankschlüssel nach erfolgreichem
        Verbindungsaufbau und Eintreten in die Datenbank (nur möglich mit
        Option <code>d</code>).</simpara>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><code>j</code></term>

      <listitem>
        <simpara>(jump) Bei falschem Passwort statt aufzulegen zur Priorität
        n+101 springen, falls diese existiert.</simpara>
      </listitem>
    </varlistentry>
  </variablelist>

  <important>
    <para>Beachten Sie bei der Option <code>d</code>, dass -- was wenig
    nachvollziehbar ist! -- als Parameter
    <code>/<replaceable>passwoerter</replaceable>/<replaceable>1234</replaceable></code>
    verlangt wird, wobei <code>passwoerter</code> die Familie ist und
    <code>1234</code> das Passwort. Der unter diesem Schlüssel gespeicherte
    Wert ist irrelevant. Der gesunde Menschenverstand würde einen
    Datenbank-Eintrag wie /passwoerter/art =&gt; 1234 erwarten.</para>
  </important>

  <simpara>Mit Angabe von <code>maxZiffern</code> wird die Eingabe automatisch
  nach so vielen Ziffern beendet, ohne dass der User <code>#</code> drücken
  muss (Default: 0 für keine Begrenzung).</simpara>

  <simpara>Liefert 0 zurück, falls der Benutzer nach maximal drei Versuchen
  ein gültiges Passwort eingegeben hat, sonst -1 (auch nach
  Auflegen).</simpara>

  <programlisting>; Passwort 1234 verlangen:
exten =&gt; 123,1,Answer()
exten =&gt; 123,2,Authenticate(1234,j,4)           ; hier ausnahmsweise mit Priority-Jumping
                                                ; weil wir dem Anrufer noch sagen wollen,
                                                ; dass sein Passwort falsch ist
exten =&gt; 123,3,Playback(pin-nummer-akzeptiert)
exten =&gt; 123,103,Playback(pin-nummer-falsch)</programlisting>

  <xi:include href="authenticate-help.xml" xpointer="xpointer(/note/*)"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <formalpara>
    <title>Siehe auch</title>

    <para><xref linkend="applications-vmauthenticate" /></para>
  </formalpara>
</section>
