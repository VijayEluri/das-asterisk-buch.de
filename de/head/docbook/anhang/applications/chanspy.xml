<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="applications-chanspy" lang="de" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>ChanSpy()</literal></title>

    <indexterm significance="preferred">
      <primary>Dialplan-Applikationen</primary>

      <secondary><code>ChanSpy()</code></secondary>
    </indexterm>

    <simpara>Einen Channel belauschen</simpara>

    <synopsis>ChanSpy([<replaceable>Channelpräfix</replaceable>[,<replaceable>Optionen</replaceable>]])</synopsis>

    <simpara>Erlaubt es, das Gespräch auf beliebigen Kanälen mitzuhören. (Ist
    also nicht wie <code>ZapBarge()</code>/<code>ZapScan()</code> an
    Zap-Kanäle gebunden.) Für das Verständnis einiger Optionen ist zu
    beachten, dass diese Applikation einzelne Kanäle abhört, aber nicht
    Gespräche im eigentlichen Sinn (min. 2 Teilnehmer), obwohl Sie natürlich
    das ein- und ausgehende Audio auf dem abgehörten Channel hören können.
    Bitte achten sie die Persönlichkeitsrechte anderer! Falls sie Gespräche
    unaufgefordert und ohne Wissen der Teilnehmer mithören machen sie sich
    strafbar.</simpara>

    <simpara>Wenn <code>Channelpräfix</code> angegeben ist, stehen nur Kanäle,
    die mit diesem String beginnen, zur Auswahl.</simpara>

    <para><code>Optionen</code> (auch in Kombination):<variablelist
        termlength="11">
        <varlistentry>
          <term><code>b</code></term>

          <listitem>
            <simpara>(bridged) Auswahl nur auf verbundene Kanäle
            beschränken.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>g(<replaceable>grp</replaceable>)</code></term>

          <listitem>
            <simpara>(group) Auswahl auf Kanäle beschränken, auf denen
            <code>grp</code> in der durch Doppelpunkt (<code>:</code>)
            getrennten Liste <code>${SPYGROUP}</code> (Channelvariable)
            enthalten ist.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>q</term>

          <listitem>
            <simpara>(quiet) Keine Piep-Töne beim Umschalten von Kanälen
            spielen und Channelname nicht ankündigen.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>r([<replaceable>Name</replaceable>])</code></term>

          <listitem>
            <para>(record) Die Sitzung in einer Datei im Verzeichnis
            <filename>/var/spool/asterisk/monitor/</filename> aufzeichnen.
            Default-Basis-Dateiname (also ohne Endung) ist
            <filename>chanspy</filename>.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>v[(<replaceable>Wert</replaceable>)]</code></term>

          <listitem>
            <para>(volume) Die anfängliche Lautstärkeeinstellung von
            <code>-4</code> (leise) bis <code>4</code> (laut)
            verändern.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>w</code></term>

          <listitem>
            <simpara>(whisper) Flüster-Modus aktivieren. Damit kann der
            lauschende Channel mit dem belauschten sprechen, wobei dies nur
            der belauschte Channel hört, nicht dessen Gesprächspartner. (Diese
            Option ist seit Asterisk 1.4 verfügbar.)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>W</code></term>

          <listitem>
            <simpara>(private whisper) Privater Flüster-Modus. Wie
            <code>w</code>, aber der lauschende Channel kann den belauschten
            nicht hören. (sinnvoll?)</simpara>
          </listitem>
        </varlistentry>
      </variablelist></para>

    <para>Während des Abhörens können folgende Tastenbefehle gegeben
    werden:<variablelist termlength="6">
        <varlistentry>
          <term><code>#</code></term>

          <listitem>
            <simpara>Schaltet durch die Lautstärkeeinstellung (-4 bis
            4)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>*</code></term>

          <listitem>
            <simpara>Schaltet zu einem anderen Channel</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code><replaceable>...</replaceable>#</code></term>

          <listitem>
            <simpara>Eine Reihe von Ziffern, abgeschlossen durch
            <code>#</code>, wird an <code>Channelpräfix</code> angehängt. Wenn
            Sie z.B. <code>ChanSpy(Agent)</code> ausführen und
            <code>1234#</code> eingeben, werden Sie auf dem Channel
            <code>Agent/1234</code> lauschen.</simpara>
          </listitem>
        </varlistentry>
      </variablelist></para>

    <programlisting>; Agenten belauschen:
exten =&gt; 123,1,ChanSpy(Agent)
exten =&gt; 123,n,Hangup()

; Beispiel für die Option g:
; auf Anrufen auf 0... SPYGROUP 10005 setzen:
exten =&gt; _0.,1,Set(SPYGROUP=10005)
;...
; Kanäle der SPYGROUP 10005 belauschen:
exten =&gt; 123,1,ChanSpy(,g(10005))
exten =&gt; 123,n,Hangup()</programlisting>

    <note>
      <formalpara>
        <title>Interner Hilfetext zu dieser Applikation in Asterisk
        1.4:</title>

        <para><screen>  -= Info about application 'ChanSpy' =- 

[Synopsis]
Listen to a channel, and optionally whisper into it

[Description]
  ChanSpy([chanprefix][|options]): This application is used to listen to the
audio from an Asterisk channel. This includes the audio coming in and
out of the channel being spied on. If the 'chanprefix' parameter is specified,
only channels beginning with this string will be spied upon.
  While spying, the following actions may be performed:
    - Dialing # cycles the volume level.
    - Dialing * will stop spying and look for another channel to spy on.
    - Dialing a series of digits followed by # builds a channel name to append
      to 'chanprefix'. For example, executing ChanSpy(Agent) and then dialing
      the digits '1234#' while spying will begin spying on the channel
      'Agent/1234'.
  Options:
    b             - Only spy on channels involved in a bridged call.
    g(grp)        - Match only channels where their ${SPYGROUP} variable is set to
                    contain 'grp' in an optional : delimited list.
    q             - Don't play a beep when beginning to spy on a channel, or speak the
                    selected channel name.
    r[(basename)] - Record the session to the monitor spool directory. An
                    optional base for the filename may be specified. The
                    default is 'chanspy'.
    v([value])    - Adjust the initial volume in the range from -4 to 4. A
                    negative value refers to a quieter setting.
    w             - Enable 'whisper' mode, so the spying channel can talk to
                    the spied-on channel.
    W             - Enable 'private whisper' mode, so the spying channel can
                    talk to the spied-on channel but cannot listen to that
                    channel.</screen></para>
      </formalpara>

      <formalpara>
        <title>Differenz zum internen Hilfetext in Asterisk 1.2:</title>

        <para><screen>5c5,6
&lt; Listen to a channel, and optionally whisper into it
---
&gt; Listen to the audio of an active channel
&gt; 
9c10
&lt; audio from an Asterisk channel. This includes the audio coming in and
---
&gt; audio from an active Asterisk channel. This includes the audio coming in and
12c13
&lt;   While spying, the following actions may be performed:
---
&gt;   While Spying, the following actions may be performed:
17c18
&lt;       the digits '1234#' while spying will begin spying on the channel
---
&gt;       the digits '1234#' while spying will begin spying on the channel,
20,24c21,24
&lt;     b             - Only spy on channels involved in a bridged call.
&lt;     g(grp)        - Match only channels where their ${SPYGROUP} variable is set to
&lt;                     contain 'grp' in an optional : delimited list.
&lt;     q             - Don't play a beep when beginning to spy on a channel, or speak the
&lt;                     selected channel name.
---
&gt;     b - Only spy on channels involved in a bridged call.
&gt;     g(grp) - Match only channels where their ${SPYGROUP} variable is set to
&gt;              'grp'.
&gt;     q - Don't play a beep when beginning to spy on a channel.
28,34c28,29
&lt;     v([value])    - Adjust the initial volume in the range from -4 to 4. A
&lt;                     negative value refers to a quieter setting.
&lt;     w             - Enable 'whisper' mode, so the spying channel can talk to
&lt;                     the spied-on channel.
&lt;     W             - Enable 'private whisper' mode, so the spying channel can
&lt;                     talk to the spied-on channel but cannot listen to that
&lt;                     channel.
---
&gt;     v([value]) - Adjust the initial volume in the range from -4 to 4. A
&gt;                  negative value refers to a quieter setting.</screen></para>
      </formalpara>
    </note>

    <formalpara>
      <title>Siehe auch</title>

      <para><xref linkend="applications-extenspy" />, <xref
      linkend="applications-zapbarge" />, <xref
      linkend="applications-zapscan" />, <xref
      linkend="applications-monitor" /></para>
    </formalpara>
</section>
