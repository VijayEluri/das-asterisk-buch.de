<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="installation-1.8-debian" lang="de" revision="$Revision:473 $">
  <!--
% Copyright (c) 2006 - 2007 by 
% 2011 Stefan Wintermeyer <sw@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

  <title>Installation von Asterisk 1.8 auf Debian Linux</title>

  <indexterm>
    <primary>Installation</primary>

    <secondary>Asterisk 1.8</secondary>

    <tertiary>Debian</tertiary>
  </indexterm>

  <para>Die hier aufgeführte Installationsanleitung gilt für ein normales
  Asterisk-System mit dem Sie schnell anfangen können zu arbeiten. </para>

  <para>Es wird ein frisch installiertes Debian GNU/Linux 6.0
  (<quote>Squeeze</quote>) vorausgesetzt. Ein ISO-Image für die Installation
  finden Sie auf <ulink
  url="http://www.debian.org/releases/lenny/debian-installer/">http://www.debian.org/releases/squeeze/debian-installer/</ulink>.
  Wir empfehlen das etwa 175 MByte große Netzinstallations-CD-Image<footnote>
      <para>In der Regel werden Sie das für die Architektur
      <literal>i386</literal> benötigen.</para>
    </footnote>. Eine Debian GNU/Linux-Installationsanleitung für i386
  kompatible Systeme findet sich unter <ulink
  url="http://www.debian.org/releases/squeeze/i386/">http://www.debian.org/releases/squeeze/i386/</ulink>.
  Ein allgemeines Anwenderhandbuch steht unter <ulink
  url="http://debiananwenderhandbuch.de">http://debiananwenderhandbuch.de</ulink>.</para>

  <note>
    <para>Bitte loggen Sie sich nach der Installation als Benutzer
    <literal>root</literal> am System ein, und führen Sie alle hier
    angegebenen Befehle mit diesem Benutzer aus.</para>
  </note>

  <note>
    <para>Einige Anwender werden wohl direkt einen SSH-Server installieren
    wollen, um von ihrem normalen Arbeitsplatz aus im Terminal auf dem Server
    arbeiten zu können. Der Befehl dazu lautet: <literal><command>aptitude
    install ssh</command></literal>. Dann kann man hier im Folgenden auch
    wunderbar mit Kopieren und Einsetzen der meisten Befehle arbeiten. Wir
    setzen voraus, dass Sie entweder mit der grundsätzlichen Verwendung von
    <command>ssh</command> vertraut sind oder direkt am System selbst
    arbeiten.</para>
  </note>

  <para>Es versteht sich von selbst, dass man auf jedem System (egal ob
  neuinstalliert oder bereits bestehend) erst einmal sicherstellt, dass die
  Paketverwaltung (APT<footnote>
      <para><ulink
      url="http://de.wikipedia.org/wiki/Advanced_Packaging_Tool">http://de.wikipedia.org/wiki/Advanced_Packaging_Tool</ulink></para>
    </footnote> bzw. <literal>aptitude</literal>) die aktuellen Paketlisten
  zur Verfügung hat ...<screen>root@debian6:~# <command>aptitude update</command>
Treffer http://ftp.de.debian.org squeeze Release.gpg
Treffer http://ftp.de.debian.org/debian/ squeeze/main Translation-de

[...]

Treffer http://security.debian.org squeeze/updates/main Sources
Treffer http://security.debian.org squeeze/updates/main i386 Packages
119 kB wurden in 0 s heruntergeladen (151 kB/s)
                                 
root@debian6:~#</screen></para>

  <para>... und dass alle Pakete auf dem neusten Stand sind:<screen>root@debian6:~# <command>aptitude -y upgrade</command>
Es werden keine Pakete installiert, aktualisiert oder entfernt.
0 Pakete aktualisiert, 0 zusätzlich installiert, 0 werden entfernt und 0 nicht aktualisiert.
Muss 0 B an Archiven herunterladen. Nach dem Entpacken werden 0 B zusätzlich belegt sein.
                                            
root@debian6:~#</screen></para>

  <para>Für den Fall, dass beim Upgrade der Pakete auch ein neuer Kernel
  installiert wurde, müssen wir jetzt das System mit
  <literal><command>shutdown -r now</command></literal> (oder mit
  <literal><command>reboot</command></literal>) neu starten:<screen>root@debian6:~# <command>shutdown -r now</command>

Broadcast message from root@debian6 (pts/0) (Sun Nov 13 06:24:43 2011):

The system is going down for reboot NOW!</screen></para>

  <para>Nach dem Booten loggen Sie sich bitte wieder als
  <literal>root</literal> ein.</para>

  <note>
    <para>Das hat zwar nichts mit Asterisk zu tun, aber typischerweise
    installiert man auch NTP, um immer die aktuelle Zeit zu haben:<screen>debian:~# <emphasis
          role="bold"><command>aptitude -y install ntp ntpdate</command></emphasis></screen>Ein
    Muss ist das natürlich nicht.</para>
  </note>

  <para>Zuerst installieren wir eine Build-Umgebung – d.h. Compiler usw. – und
  diverse Abhängigkeiten, damit das Kompilieren von Asterisk erfolgreich
  durchgeführt werden kann.<screen>debian:~# <emphasis role="bold"><command>aptitude -y install build-essential libxml2-dev libncurses5-dev</command></emphasis>
Die folgenden NEUEN Pakete werden zusätzlich installiert:
  binutils{a} build-essential bzip2{a} cpp{a} cpp-4.3{a} 
  dpkg-dev{a} g++{a} g++-4.3{a} gcc{a} gcc-4.3{a} 
<replaceable>[...]</replaceable>
</screen></para>

  <para>Jetzt haben Sie ein System, auf dem man problemlos Asterisk
  kompilieren kann.</para>

  <bridgehead id="installation-1.6-debian-asterisk">Asterisk</bridgehead>

  <para>Auf der Asterisk-Homepage <ulink
  url="http://www.asterisk.org/">http://www.asterisk.org</ulink> finden Sie
  die notwendigen Quellen, um Asterisk zu installieren.</para>

  <important>
    <para>Bitte suchen Sie auf <ulink
    url="http://www.asterisk.org/">http://www.asterisk.org</ulink> immer nach
    der aktuellen 10.0er Version für das folgenden <command>wget</command>
    Kommando.</para>
  </important>

  <para><screen>root@debian6:~# <command>cd /usr/src</command>
root@debian6:/usr/src# <command>wget http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-1.8-current.tar.gz</command>
--2011-11-13 11:14:59--  http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-1.8-current.tar.gz
Auflösen des Hostnamen downloads.asterisk.org... 76.164.171.233, 2001:470:e0d4::e9
Verbindungsaufbau zu downloads.asterisk.org|76.164.171.233|:80... verbunden.
HTTP-Anforderung gesendet, warte auf Antwort... 200 OK
Länge: 28557326 (27M) [application/x-gzip]
In »asterisk-1.8-current.tar.gz« speichern.

100%[======================================&gt;] 28.557.326   423K/s   in 69s     

2011-11-13 11:16:10 (405 KB/s) - »asterisk-1.8-current.tar.gz« gespeichert [28557326/28557326]

root@debian6:/usr/src#</screen></para>

  <para>Entpacken:<screen>root@debian6:/usr/src# <command>tar xzf asterisk-1.8-current.tar.gz</command> 
root@debian6:/usr/src#</screen></para>

  <para>Kompilierung vorbereiten:<screen>root@debian6:/usr/src# <command>cd asterisk-1.8.7.1</command>
root@debian6:/usr/src/asterisk-1.8.7.1# <command>./configure</command> 
checking build system type... i686-pc-linux-gnu
checking host system type... i686-pc-linux-gnu
checking for gcc... gcc

[...]

configure: OS type  : linux-gnu
configure: Host CPU : i686
configure: build-cpu:vendor:os: i686 : pc : linux-gnu :
configure: host-cpu:vendor:os: i686 : pc : linux-gnu :
root@debian6:/usr/src/asterisk-1.8.7.1#</screen></para>

  <para>Kompilieren<footnote>
      <para>An dieser Stelle vor dem Kompilieren könnte man als erfahrenerer
      Asterisk-Benutzer mit <literal><command>make
      menuselect</command></literal> in einem interaktiven Dialog bestimmte
      Module deaktivieren.</para>
    </footnote>:<screen>root@debian6:/usr/src/asterisk-1.8.7.1# <command>make</command>
CC="cc" CXX="" LD="" AR="" RANLIB="" CFLAGS="" make -C menuselect CONFIGURE_SILENT="--silent" menuselect
make[1]: Entering directory `/usr/src/asterisk-1.8.7.1/menuselect'
gcc -g -c -D_GNU_SOURCE -Wall   -c -o menuselect.o menuselect.c


[...]

Building Documentation For: channels pbx apps codecs formats cdr cel bridges funcs tests main res addons 
 +--------- Asterisk Build Complete ---------+
 + Asterisk has successfully been built, and +
 + can be installed by running:              +
 +                                           +
 +                make install               +
 +-------------------------------------------+
root@debian6:/usr/src/asterisk-1.8.7.1#</screen></para>

  <para>Installieren:<screen>root@debian6:/usr/src/asterisk-1.8.7.1# <command>make install</command>
/usr/bin/install -c -d "/usr/lib/asterisk/modules"
/usr/bin/install -c -d "/usr/sbin"
/usr/bin/install -c -d "/etc/asterisk"

[...]

make[1]: Leaving directory `/usr/src/asterisk-1.8.7.1/sounds'
 +---- Asterisk Installation Complete -------+
 +                                           +
 +    YOU MUST READ THE SECURITY DOCUMENT    +
 +                                           +
 + Asterisk has successfully been installed. +
 + If you would like to install the sample   +
 + configuration files (overwriting any      +
 + existing config files), run:              +
 +                                           +
 +                make samples               +
 +                                           +
 +-----------------  or ---------------------+
 +                                           +
 + You can go ahead and install the asterisk +
 + program documentation now or later run:   +
 +                                           +
 +               make progdocs               +
 +                                           +
 + **Note** This requires that you have      +
 + doxygen installed on your local system    +
 +-------------------------------------------+
root@debian6:/usr/src/asterisk-1.8.7.1#</screen></para>

  <para>Die eben kompilierten Programmdateien sind jetzt auf dem System
  installiert. Allerdings finden wir im Asterisk-Konfigurationsverzeichnis
  <filename>/etc/asterisk/</filename> noch gähnende Leere vor. Da wir nicht
  von Grund auf beginnen möchten, lassen wir uns die Standard-Beispieldateien
  erstellen:<screen>root@debian6:/usr/src/asterisk-1.8.7.1# <command>make samples</command>
Installing adsi config files...
/usr/bin/install -c -d "/etc/asterisk"
Installing configs/asterisk.adsi
Installing configs/telcordia-1.adsi
Installing other config files...

[...]

Installing file phoneprov/polycom.xml
Installing file phoneprov/snom-mac.xml
root@debian6:/usr/src/asterisk-1.8.7.1#</screen></para>

  <para>Damit Asterisk beim Booten des Rechners auch automatisch gestartet und
  bei einem Shutdown ordentlich gestoppt wird, benötigen wir noch
  entsprechende Init-Skripte:<screen>root@debian6:/usr/src/asterisk-1.8.7.1# <command>make config</command>
update-rc.d: using dependency based boot sequencing
root@debian6:/usr/src/asterisk-1.8.7.1# </screen></para>

  <para>Fertig! Asterisk ist auf Ihrem System installiert. Mit dem Befehl
  <literal><command>asterisk -V</command></literal> können Sie die
  installierte Version herausfinden (bitte achten Sie auf das großgeschriebene
  V):<screen>root@debian6:/usr/src/asterisk-1.8.7.1# <command>asterisk -V</command>
Asterisk 1.8.7.1
root@debian6:/usr/src/asterisk-1.8.7.1# </screen></para>
</section>
