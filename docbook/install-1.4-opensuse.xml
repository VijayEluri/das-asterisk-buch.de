<?xml version="1.0" encoding="ISO-8859-1"?>
<section id="installation-1.4-debian" lang="de" revision="$Revision: 1.1 $">
  <!--% Copyright (c) 2006 - Stefan Wintermeyer <sw@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de-->

  <title>Installation Asterisk 1.4.x auf Debian Linux</title>

  <para>Diese Installationsanleitung setzt ein frisch installiertes Debian
  GNU/Linux 3.1 (a.k.a sarge) voraus. Ein ISO-Image für eine entsprechende
  i386er Debian Linux Installation finden Sie unter <ulink
  url="http://cdimage.debian.org/debian-cd/3.1_r4/i386/iso-cd/debian-31r4-i386-netinst.iso"><citetitle>http://cdimage.debian.org/debian-cd/3.1_r4/i386/iso-cd/debian-31r4-i386-netinst.iso</citetitle></ulink>.
  Eine Debian GNU/Linux-Installationsanleitung finden Sie unter <ulink
  url="http://www.debian.org/releases/stable/i386/"><citetitle>http://www.debian.org/releases/stable/i386/</citetitle></ulink></para>

  <para><emphasis>Bitte logen Sie sich als Benutzer root in das System ein und
  führen Sie alle hier angegebenen Befehle mit diesem Benutzer
  aus.</emphasis></para>

  <para>Als erstes stellen Sie mit einem <command>apt-get update</command>
  sicher, das <code>apt-get</code> alle aktuellen Paketlisten zur Verfügung
  hat:<screen>debian:~# apt-get updateyyy123yyysw
OK   http://ftp.de.debian.org stable/main Packagesyyy123yyysw
OK   http://ftp.de.debian.org stable/main Releaseyyy123yyysw
OK   http://security.debian.org stable/updates/main Packagesyyy123yyysw
OK   http://security.debian.org stable/updates/main Releaseyyy123yyysw
OK   http://security.debian.org stable/updates/contrib Packagesyyy123yyysw
OK   http://security.debian.org stable/updates/contrib Releaseyyy123yyysw
OK   http://ftp.de.debian.org stable/main Sourcesyyy123yyysw
OK   http://ftp.de.debian.org stable/main Releaseyyy123yyysw
Paketlisten werden gelesen... Fertigyyy123yyysw</screen></para>

  <para>Danach führen Sie sicherheitshalber noch ein apt-get upgrade
  aus:<screen>debian:~# apt-get upgradeyyy123yyysw
Paketlisten werden gelesen... Fertigyyy123yyysw
Abhängigkeitsbaum wird aufgebaut... Fertigyyy123yyysw
0 aktualisiert, 0 neu installiert, 0 zu entfernen und 0 nicht aktualisiert.yyy123yyysw</screen></para>

  <para>Jetzt müssen Sie mit <command>apt-get -y install
  libncurses5-dev</command> noch ein Paket nachinstallieren, damit das
  Kompilieren von Asterisk erfolgreich durchgeführt werden kann:</para>

  <screen>debian:~# apt-get -y install libncurses5-devyyy123yyysw
Paketlisten werden gelesen... Fertigyyy123yyysw
Abhängigkeitsbaum wird aufgebaut... Fertigyyy123yyysw
Die folgenden NEUEN Pakete werden installiert:yyy123yyysw
  libncurses5-devyyy123yyysw
0 aktualisiert, 1 neu installiert, 0 zu entfernen und 0 nicht aktualisiert.yyy123yyysw
Es müssen noch 0B von 1038kB Archiven geholt werden.yyy123yyysw
Nach dem Auspacken werden 5296kB Plattenplatz zusätzlich benutzt.yyy123yyysw
Wähle vormals abgewähltes Paket libncurses5-dev.yyy123yyysw
(Lese Datenbank ... 21874 Dateien und Verzeichnisse sind derzeit installiert.)yyy123yyysw
Entpacke libncurses5-dev (aus .../libncurses5-dev_5.4-4_i386.deb) ...yyy123yyysw
Richte libncurses5-dev ein (5.4-4) ...yyy123yyysw
debian:~# yyy123yyysw
</screen>

  <para>Auf der Asterisk-Homepage <ulink
  url="http://www.asterisk.org/"><citetitle>http://www.asterisk.org/</citetitle></ulink>
  finden Sie die notwendigen Quellen, um Asterisk zu kompilieren. Nehmen Sie
  bitte eine stabile und keine Entwickler-Version und laden Sie diese mit
  <command>wget
  http://ftp.digium.com/pub/asterisk/asterisk-1.4-current.tar.gz</command> in
  das Verzeichnis <filename>/usr/src/</filename> runter:</para>

  <screen>debian:~# cd /usr/srcyyy123yyysw
debian:/usr/src# wget http://ftp.digium.com/pub/asterisk/asterisk-1.4-current.tar.gzyyy123yyysw
--18:53:00--  http://ftp.digium.com/pub/asterisk/asterisk-1.4-current.tar.gzyyy123yyysw
           =&gt; `asterisk-1.4-current.tar.gz'yyy123yyysw
Auflösen des Hostnamen »ftp.digium.com«.... 69.16.138.164yyy123yyysw
Verbindungsaufbau zu ftp.digium.com[69.16.138.164]:80... verbunden.yyy123yyysw
HTTP Anforderung gesendet, warte auf Antwort... 200 OKyyy123yyysw
Länge: 10,928,902 [application/x-gzip]yyy123yyysw
yyy123yyysw
100%[====================================&gt;] 10,928,902   230.71K/s    ETA 00:00yyy123yyysw
yyy123yyysw
18:53:47 (227.00 KB/s) - »asterisk-1.4-current.tar.gz« gespeichert [10928902/10928902]yyy123yyysw
</screen>

  <para>Die komprimierte Datei muss jetzt mit <command>tar xvzf</command>
  entpackt werden:<screen>debian:/usr/src# tar xvzf asterisk-1.4-current.tar.gz yyy123yyysw
asterisk-1.4.0/yyy123yyysw
asterisk-1.4.0/build_tools/yyy123yyysw
asterisk-1.4.0/build_tools/mkpkgconfigyyy123yyysw
asterisk-1.4.0/build_tools/get_moduleinfoyyy123yyysw
asterisk-1.4.0/build_tools/mkdepyyy123yyysw
asterisk-1.4.0/build_tools/get_makeoptsyyy123yyysw
asterisk-1.4.0/build_tools/make_versionyyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
asterisk-1.4.0/menuselect/mxml/COPYINGyyy123yyysw
asterisk-1.4.0/menuselect/mxml/CHANGESyyy123yyysw
asterisk-1.4.0/menuselect/mxml/mxml-file.cyyy123yyysw
asterisk-1.4.0/menuselect/mxml/install-shyyy123yyysw
asterisk-1.4.0/menuselect/mxml/mxml.pcyyy123yyysw
debian:/usr/src# yyy123yyysw</screen></para>

  <para>Asterisk 1.4 ist die erste Version, die den allgemein üblichen
  autoconf Mechanismus benutzt. Als erstes muss also im Asterisk Verzeichnis
  ein <command>./configure</command> aufgerufen werden:<screen>debian:/usr/src# cd asterisk-1.4.0/yyy123yyysw
debian:/usr/src/asterisk-1.4.0# ./configure yyy123yyysw
checking build system type... i686-pc-linux-gnuyyy123yyysw
checking host system type... i686-pc-linux-gnuyyy123yyysw
checking for uname... /bin/unameyyy123yyysw
checking for gcc... gccyyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
configure: creating ./config.statusyyy123yyysw
config.status: creating build_tools/menuselect-depsyyy123yyysw
config.status: creating makeoptsyyy123yyysw
config.status: creating channels/h323/Makefileyyy123yyysw
config.status: creating include/asterisk/autoconfig.hyyy123yyysw
yyy123yyysw
               .$$$$$$$$$$$$$$$=..      yyy123yyysw
            .$7$7..          .7$$7:.    yyy123yyysw
          .$$:.                 ,$7.7   yyy123yyysw
        .$7.     7$$$$           .$$77  yyy123yyysw
     ..$$.       $$$$$            .$$$7 yyy123yyysw
    ..7$   .?.   $$$$$   .?.       7$$$.yyy123yyysw
   $.$.   .$$$7. $$$$7 .7$$$.      .$$$.yyy123yyysw
 .777.   .$$$$$$77$$$77$$$$$7.      $$$,yyy123yyysw
 $$$~      .7$$$$$$$$$$$$$7.       .$$$.yyy123yyysw
.$$7          .7$$$$$$$7:          ?$$$.yyy123yyysw
$$$          ?7$$$$$$$$$$I        .$$$7 yyy123yyysw
$$$       .7$$$$$$$$$$$$$$$$      :$$$. yyy123yyysw
$$$       $$$$$$7$$$$$$$$$$$$    .$$$.  yyy123yyysw
$$$        $$$   7$$$7  .$$$    .$$$.   yyy123yyysw
$$$$             $$$$7         .$$$.    yyy123yyysw
7$$$7            7$$$$        7$$$      yyy123yyysw
 $$$$$                        $$$       yyy123yyysw
  $$$$7.                       $$  (TM)     yyy123yyysw
   $$$$$$$.           .7$$$$$$  $$      yyy123yyysw
     $$$$$$$$$$$$7$$$$$$$$$.$$$$$$      yyy123yyysw
       $$$$$$$$$$$$$$$$.                yyy123yyysw
yyy123yyysw
configure: Package configured for: yyy123yyysw
configure: OS type  : linux-gnuyyy123yyysw
configure: Host CPU : i686yyy123yyysw
debian:/usr/src/asterisk-1.4.0# yyy123yyysw</screen></para>

  <para>Die entpackten Dateien müssen jetzt kompiliert werden.<footnote>
      <para>Die Linux-Cracks unter den Lesern mögen mir diese starke
      Vereinfachung verzeihen.</para>
    </footnote>Dies geschieht mit dem Befehl <command>make</command> im gerade
  entpackten Verzeichnis.<warning>
      <para>Bitte achten Sie darauf, das die hier in der Dokumentation
      benutzte Version vielleicht zum Zeitpunkt Ihrer Installation nicht mehr
      aktuell ist. Entsprechend werden sich die Verzeichnisnamen
      ändern.</para>
    </warning> Übrigens ist dies jetzt ein guter Moment, sich den
  obligatorischen Kaffee oder Tee zu kochen. Der Kompiliervorgang kann je nach
  Rechenleistung des PCs wenige Minuten oder bis zu einer Stunde
  dauern.</para>

  <screen>debian:/usr/src/asterisk-1.4.0# makeyyy123yyysw
make[1]: Entering directory `/usr/src/asterisk-1.4.0/menuselect'yyy123yyysw
checking for gcc... gccyyy123yyysw
checking for C compiler default output file name... a.outyyy123yyysw
checking whether the C compiler works... yesyyy123yyysw
checking whether we are cross compiling... noyyy123yyysw
checking for suffix of executables... yyy123yyysw
checking for suffix of object files... oyyy123yyysw
checking whether we are using the GNU C compiler... yesyyy123yyysw
checking whether gcc accepts -g... yesyyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
   [LD] abstract_jb.o acl.o aescrypt.o aeskey.o aestab.o alaw.o app.o ast_expr2.o ast_expr2f.o asterisk.o astmm.o autoservice.o callerid.o cdr.o channel.o chanvars.o cli.o config.o cryptostub.o db.o devicestate.o dns.o dnsmgr.o dsp.o enum.o file.o fixedjitterbuf.o frame.o fskmodem.o http.o image.o indications.o io.o jitterbuf.o loader.o logger.o manager.o md5.o netsock.o pbx.o plc.o privacy.o rtp.o say.o sched.o sha1.o slinfactory.o srv.o stdtime/localtime.o strcompat.o tdd.o term.o translate.o udptl.o ulaw.o utils.o editline/libedit.a db1-ast/libdb1.a -&gt; asteriskyyy123yyysw
 +--------- Asterisk Build Complete ---------+yyy123yyysw
 + Asterisk has successfully been built, and +yyy123yyysw
 + can be installed by running:              +yyy123yyysw
 +                                           +yyy123yyysw
 +               make install                +yyy123yyysw
 +-------------------------------------------+yyy123yyysw
debian:/usr/src/asterisk-1.4.0# yyy123yyysw
</screen>

  <para>Die Software ist jetzt kompiliert und muss nur noch mit <command>make
  install</command> installiert (sprich in die richtigen Verzeichnisse
  kopiert) werden:</para>

  <screen>debian:/usr/src/asterisk-1.4.0# make installyyy123yyysw
make[1]: Für das Ziel »depend« ist nichts zu tun.yyy123yyysw
make[1]: Für das Ziel »depend« ist nichts zu tun.yyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
for x in ; do /usr/bin/install -c -m 755 $x /usr/lib/asterisk/modules ; doneyyy123yyysw
make[1]: Leaving directory `/usr/src/asterisk-1.4.0/main'yyy123yyysw
 +---- Asterisk Installation Complete -------+yyy123yyysw
 +                                           +yyy123yyysw
 +    YOU MUST READ THE SECURITY DOCUMENT    +yyy123yyysw
 +                                           +yyy123yyysw
 + Asterisk has successfully been installed. +yyy123yyysw
 + If you would like to install the sample   +yyy123yyysw
 + configuration files (overwriting any      +yyy123yyysw
 + existing config files), run:              +yyy123yyysw
 +                                           +yyy123yyysw
 +               make samples                +yyy123yyysw
 +                                           +yyy123yyysw
 +-----------------  or ---------------------+yyy123yyysw
 +                                           +yyy123yyysw
 + You can go ahead and install the asterisk +yyy123yyysw
 + program documentation now or later run:   +yyy123yyysw
 +                                           +yyy123yyysw
 +              make progdocs                +yyy123yyysw
 +                                           +yyy123yyysw
 + **Note** This requires that you have      +yyy123yyysw
 + doxygen installed on your local system    +yyy123yyysw
 +-------------------------------------------+yyy123yyysw
debian:/usr/src/asterisk-1.4.0# yyy123yyysw</screen>

  <para>Die eben kompilierten Programmdateien sind jetzt auf dem System
  installiert. Allerdings finden wir im Asterisk Konfigurationsverzeichnis
  <filename>/etc/asterisk/</filename> noch gähnende Leere vor. In diesem
  Verzeichnis liegen die Konfigurationsdateien von Asterisk und da wir nicht
  von Null beginnen möchten, lassen wir uns die Standarddateien erstellen.
  Dies erreichen wir mit einem <command>make samples</command>:</para>

  <screen>debian:/usr/src/asterisk-1.4.0# make samplesyyy123yyysw
mkdir -p /etc/asteriskyyy123yyysw
for x in configs/*.adsi; do \yyy123yyysw
        if [ ! -f /etc/asterisk/$x ]; then \yyy123yyysw
                /usr/bin/install -c -m 644 $x /etc/asterisk/`/usr/bin/basename $x` ; \yyy123yyysw
        fi ; \yyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
for x in vm-theperson digits/1 digits/2 digits/3 digits/4 vm-isonphone; do \yyy123yyysw
        cat /var/lib/asterisk/sounds/$x.gsm &gt;&gt; /var/spool/asterisk/voicemail/default/1234/busy.gsm ; \yyy123yyysw
doneyyy123yyysw
debian:/usr/src/asterisk-1.4.0# yyy123yyysw</screen>

  <para>Fertig! Asterisk ist auf Ihrem System installiert. Mit dem Befehl
  <command>asterisk -V</command> können Sie die installierte Version
  rausfinden (bitte achten Sie auf das grossgeschriebene V):<screen>debian:/usr/src/asterisk-1.4.0# asterisk -Vyyy123yyysw
Asterisk 1.4.0yyy123yyysw
debian:/usr/src/asterisk-1.4.0# yyy123yyysw</screen></para>
</section>