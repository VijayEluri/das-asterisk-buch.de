<?xml version="1.0" encoding="UTF-8"?>
<section id="installation-1.4-ubuntu" lang="de" revision="$Revision: 1.2 $">
  <!--% Copyright (c) 2006 - Stefan Wintermeyer <sw@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation;
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de-->

  <title>Installation Asterisk 1.4.x auf Ubuntu Linux</title>

  <para>Da Ubuntu auch von der CD als Live-System gebootet werden kann, müssen
  Sie es nicht zwangsläufig auf der Festplatte installieren (gut zum Testen).
  Diese Anleitung wurde mit einem Ubuntu 6.06.1 LTS (Dapper Drake) ausgeführt
  bzw. setzt dieses voraus. Das entsprechende ISO-Image finden Sie unter
  <ulink
  url="http://de.archive.ubuntu.com/ubuntu-releases/6.06/ubuntu-6.06.1-desktop-i386.iso"><citetitle>http://de.archive.ubuntu.com/ubuntu-releases/6.06/ubuntu-6.06.1-desktop-i386.iso</citetitle></ulink>.
  Wir benutzen die Desktop-CD. Der gleiche Installationsweg funktioniert aber
  auch bei der Server-CD. Hierbei sollte aber vor der Installation von
  Asterisk noch ein <command>sudo apt-get update</command> und ein
  <command>sudo apt-get -y upgrade</command> durchgeführt werden, um
  sicherzustellen, dass alle aktuellen Security Fixes installiert sind.</para>

  <para>Weitere Informationen zu Ubuntu finden Sie auf <ulink
  url="http://www.ubuntu.com"><citetitle>http://www.ubuntu.com</citetitle></ulink>.</para>

  <tip>
    <para>Eine Liste von FTP-Mirrors zum Download des ISO-Images finden Sie
    auf <ulink
    url="http://www.ubuntu.com/products/GetUbuntu/download#lts"><citetitle>http://www.ubuntu.com/products/GetUbuntu/download#lts.</citetitle></ulink></para>
  </tip>

  <para><emphasis>Da auf einem Ubuntu-System root-Befehle immer über sudo
  (siehe <ulink
  url="http://de.wikipedia.org/wiki/Sudo"><citetitle>http://de.wikipedia.org/wiki/Sudo</citetitle></ulink>)
  erfolgen, können Sie diese Installationsanleitung mit dem Benutzer ubuntu
  ausführen. Bitte öffnen Sie nach dem Starten von Ubuntu einfach ein
  Terminal-Fenster (im Menü oben links -&gt; Applications -&gt; Accessories
  -&gt; Terminal).</emphasis></para>

  <para>Als Erstes stellen Sie mit einem <command>sudo apt-get
  update</command> sicher, dass <code>apt-get</code> alle aktuellen
  Paketlisten zur Verfügung hat:<screen>ubuntu@ubuntu:~$ sudo apt-get updateyyy123yyysw
Get:1 http://security.ubuntu.com dapper-security Release.gpg [191B]yyy123yyysw
Hit http://security.ubuntu.com dapper-security Releaseyyy123yyysw
Get:2 http://archive.ubuntu.com dapper Release.gpg [189B]                  yyy123yyysw
Get:3 http://archive.ubuntu.com dapper-updates Release.gpg [191B]yyy123yyysw
Hit http://security.ubuntu.com dapper-security/main Packagesyyy123yyysw
Hit http://archive.ubuntu.com dapper Releaseyyy123yyysw
Hit http://security.ubuntu.com dapper-security/restricted Packages  yyy123yyysw
Hit http://security.ubuntu.com dapper-security/main Sourcesyyy123yyysw
Hit http://archive.ubuntu.com dapper-updates Releaseyyy123yyysw
Hit http://security.ubuntu.com dapper-security/restricted Sources   yyy123yyysw
Hit http://archive.ubuntu.com dapper/main Packagesyyy123yyysw
Hit http://archive.ubuntu.com dapper/restricted Packagesyyy123yyysw
Hit http://archive.ubuntu.com dapper/main Sourcesyyy123yyysw
Hit http://archive.ubuntu.com dapper/restricted Sourcesyyy123yyysw
Hit http://archive.ubuntu.com dapper-updates/main Packagesyyy123yyysw
Hit http://archive.ubuntu.com dapper-updates/restricted Packagesyyy123yyysw
Hit http://archive.ubuntu.com dapper-updates/main Sourcesyyy123yyysw
Hit http://archive.ubuntu.com dapper-updates/restricted Sourcesyyy123yyysw
Fetched 3B in 1s (2B/s)  yyy123yyysw
Reading package lists... Doneyyy123yyysw
ubuntu@ubuntu:~$ yyy123yyysw</screen></para>

  <para>Jetzt müssen Sie mit <command>apt-get -y install make gcc g++
  libncurses5-dev</command> noch ein paar Pakete nachinstallieren, damit das
  Kompilieren von Asterisk erfolgreich durchgeführt werden kann:</para>

  <screen>ubuntu@ubuntu:~$ sudo apt-get -y install make gcc g++ libncurses5-devyyy123yyysw
Reading package lists... Doneyyy123yyysw
Building dependency tree... Doneyyy123yyysw
The following extra packages will be installed:yyy123yyysw
  binutils cpp cpp-4.0 g++-4.0 gcc-4.0 libc6-dev libstdc++6-4.0-devyyy123yyysw
  linux-kernel-headersyyy123yyysw
Suggested packages:yyy123yyysw
  binutils-doc cpp-doc gcc-4.0-locales gcc-4.0-doc lib64stdc++6 manpages-devyyy123yyysw
  autoconf automake1.9 libtool flex bison gcc-doc libc6-dev-amd64 lib64gcc1yyy123yyysw
  glibc-doc libstdc++6-4.0-doc stl-manualyyy123yyysw
Recommended packages:yyy123yyysw
  libmudflap0-devyyy123yyysw
The following NEW packages will be installed:yyy123yyysw
  binutils cpp cpp-4.0 g++ g++-4.0 gcc gcc-4.0 libc6-dev libncurses5-devyyy123yyysw
  libstdc++6-4.0-dev linux-kernel-headers makeyyy123yyysw
0 upgraded, 12 newly installed, 0 to remove and 0 not upgraded.yyy123yyysw
Need to get 13.1MB of archives.yyy123yyysw
After unpacking 52.6MB of additional disk space will be used.yyy123yyysw
Get:1 http://security.ubuntu.com dapper-security/main binutils 2.16.1cvs20060117-1ubuntu2.1 [1407kB]yyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
Setting up g++-4.0 (4.0.3-1ubuntu5) ...yyy123yyysw
Setting up libstdc++6-4.0-dev (4.0.3-1ubuntu5) ...yyy123yyysw
Setting up g++ (4.0.3-1) ...yyy123yyysw
yyy123yyysw
ubuntu@ubuntu:~$ yyy123yyysw</screen>

  <para>Auf der Asterisk-Homepage <ulink
  url="http://www.asterisk.org/"><citetitle>http://www.asterisk.org/</citetitle></ulink>
  finden Sie die notwendigen Quellen, um Asterisk zu kompilieren. Nehmen Sie
  bitte eine stabile und keine Entwickler-Version und laden Sie diese mit
  <command>wget
  http://ftp.digium.com/pub/asterisk/asterisk-1.4-current.tar.gz</command> in
  das Verzeichnis <filename>/tmp</filename> herunter:</para>

  <screen>ubuntu@ubuntu:/tmp$ wget http://ftp.digium.com/pub/asterisk/asterisk-1.4-current.tar.gzyyy123yyysw
--11:16:56--  http://ftp.digium.com/pub/asterisk/asterisk-1.4-current.tar.gzyyy123yyysw
           =&gt; `asterisk-1.4-current.tar.gz'yyy123yyysw
Resolving ftp.digium.com... 216.27.40.102, 69.16.138.164yyy123yyysw
Connecting to ftp.digium.com|216.27.40.102|:80... connected.yyy123yyysw
HTTP request sent, awaiting response... 200 OKyyy123yyysw
Length: 10,928,902 (10M) [application/x-gzip]yyy123yyysw
yyy123yyysw
100%[====================================&gt;] 10,928,902   228.90K/s    ETA 00:00yyy123yyysw
yyy123yyysw
11:17:44 (228.19 KB/s) - `asterisk-1.4-current.tar.gz' saved [10928902/10928902]yyy123yyysw
yyy123yyysw
ubuntu@ubuntu:/tmp$ yyy123yyysw
</screen>

  <para>Die komprimierte Datei muss jetzt mit <command>tar xvzf
  asterisk-1.4-current.tar.gz</command> entpackt werden:<screen>ubuntu@ubuntu:/tmp$ tar xvzf asterisk-1.4-current.tar.gz yyy123yyysw
asterisk-1.4.0/yyy123yyysw
asterisk-1.4.0/build_tools/yyy123yyysw
asterisk-1.4.0/build_tools/mkpkgconfigyyy123yyysw
asterisk-1.4.0/build_tools/get_moduleinfoyyy123yyysw
asterisk-1.4.0/build_tools/mkdepyyy123yyysw
asterisk-1.4.0/build_tools/get_makeoptsyyy123yyysw
asterisk-1.4.0/build_tools/make_versionyyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
asterisk-1.4.0/menuselect/mxml/COPYINGyyy123yyysw
asterisk-1.4.0/menuselect/mxml/CHANGESyyy123yyysw
asterisk-1.4.0/menuselect/mxml/mxml-file.cyyy123yyysw
asterisk-1.4.0/menuselect/mxml/install-shyyy123yyysw
asterisk-1.4.0/menuselect/mxml/mxml.pcyyy123yyysw
ubuntu@ubuntu:/tmp$ yyy123yyysw</screen></para>

  <para>Asterisk 1.4 ist die erste Version, die den allgemein üblichen
  autoconf-Mechanismus benutzt. Zuerst muss also im Asterisk-Verzeichnis ein
  <command>./configure</command> aufgerufen werden:<screen>ubuntu@ubuntu:/tmp$ cd asterisk-1.4.0/yyy123yyysw
ubuntu@ubuntu:/tmp/asterisk-1.4.0$ ./configure yyy123yyysw
checking build system type... i686-pc-linux-gnuyyy123yyysw
checking host system type... i686-pc-linux-gnuyyy123yyysw
checking for uname... /bin/unameyyy123yyysw
checking for gcc... gccyyy123yyysw
yyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
configure: creating ./config.statusyyy123yyysw
config.status: creating build_tools/menuselect-depsyyy123yyysw
config.status: creating makeoptsyyy123yyysw
config.status: creating channels/h323/Makefileyyy123yyysw
config.status: creating include/asterisk/autoconfig.hyyy123yyysw
yyy123yyysw
               .$$$$$$$$$$$$$$$=..      yyy123yyysw
            .$7$7..          .7$$7:.    yyy123yyysw
          .$$:.                 ,$7.7   yyy123yyysw
        .$7.     7$$$$           .$$77  yyy123yyysw
     ..$$.       $$$$$            .$$$7 yyy123yyysw
    ..7$   .?.   $$$$$   .?.       7$$$.yyy123yyysw
   $.$.   .$$$7. $$$$7 .7$$$.      .$$$.yyy123yyysw
 .777.   .$$$$$$77$$$77$$$$$7.      $$$,yyy123yyysw
 $$$~      .7$$$$$$$$$$$$$7.       .$$$.yyy123yyysw
.$$7          .7$$$$$$$7:          ?$$$.yyy123yyysw
$$$          ?7$$$$$$$$$$I        .$$$7 yyy123yyysw
$$$       .7$$$$$$$$$$$$$$$$      :$$$. yyy123yyysw
$$$       $$$$$$7$$$$$$$$$$$$    .$$$.  yyy123yyysw
$$$        $$$   7$$$7  .$$$    .$$$.   yyy123yyysw
$$$$             $$$$7         .$$$.    yyy123yyysw
7$$$7            7$$$$        7$$$      yyy123yyysw
 $$$$$                        $$$       yyy123yyysw
  $$$$7.                       $$  (TM)     yyy123yyysw
   $$$$$$$.           .7$$$$$$  $$      yyy123yyysw
     $$$$$$$$$$$$7$$$$$$$$$.$$$$$$      yyy123yyysw
       $$$$$$$$$$$$$$$$.                yyy123yyysw
yyy123yyysw
configure: Package configured for: yyy123yyysw
configure: OS type  : linux-gnuyyy123yyysw
configure: Host CPU : i686yyy123yyysw
ubuntu@ubuntu:/tmp/asterisk-1.4.0$ yyy123yyysw</screen></para>

  <para>Die entpackten Dateien müssen jetzt kompiliert werden.<footnote>
      <para>Die Linux-Cracks unter den Lesern mögen mir diese starke
      Vereinfachung verzeihen.</para>
    </footnote>Dies geschieht mit dem Befehl <command>make</command> im gerade
  entpackten Verzeichnis.<warning>
      <para>Bitte achten Sie darauf, dass die hier in der Dokumentation
      benutzte Version vielleicht zum Zeitpunkt Ihrer Installation nicht mehr
      aktuell ist. Entsprechend werden sich die Verzeichnisnamen
      ändern.</para>
    </warning>Übrigens ist dies jetzt ein guter Moment, sich den
  obligatorischen Kaffee oder Tee zu kochen. Der Kompiliervorgang kann je nach
  Rechenleistung des PCs wenige Minuten oder bis zu einer Stunde
  dauern.</para>

  <screen>debian:/usr/src/asterisk-1.4.0# makeyyy123yyysw
make[1]: Entering directory `/usr/src/asterisk-1.4.0/menuselect'yyy123yyysw
checking for gcc... gccyyy123yyysw
checking for C compiler default output file name... a.outyyy123yyysw
checking whether the C compiler works... yesyyy123yyysw
checking whether we are cross compiling... noyyy123yyysw
checking for suffix of executables... yyy123yyysw
checking for suffix of object files... oyyy123yyysw
checking whether we are using the GNU C compiler... yesyyy123yyysw
checking whether gcc accepts -g... yesyyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
   [LD] abstract_jb.o acl.o aescrypt.o aeskey.o aestab.o alaw.o app.o ast_expr2.o ast_expr2f.o asterisk.o astmm.o autoservice.o callerid.o cdr.o channel.o chanvars.o cli.o config.o cryptostub.o db.o devicestate.o dns.o dnsmgr.o dsp.o enum.o file.o fixedjitterbuf.o frame.o fskmodem.o http.o image.o indications.o io.o jitterbuf.o loader.o logger.o manager.o md5.o netsock.o pbx.o plc.o privacy.o rtp.o say.o sched.o sha1.o slinfactory.o srv.o stdtime/localtime.o strcompat.o tdd.o term.o translate.o udptl.o ulaw.o utils.o editline/libedit.a db1-ast/libdb1.a -&gt; asteriskyyy123yyysw
 +--------- Asterisk Build Complete ---------+yyy123yyysw
 + Asterisk has successfully been built, and +yyy123yyysw
 + can be installed by running:              +yyy123yyysw
 +                                           +yyy123yyysw
 +               make install                +yyy123yyysw
 +-------------------------------------------+yyy123yyysw
debian:/usr/src/asterisk-1.4.0# yyy123yyysw
</screen>

  <para>Die Software ist jetzt kompiliert und muss nur noch mit <command>sudo
  make install</command> installiert (sprich in die richtigen Verzeichnisse
  kopiert) werden:</para>

  <screen>ubuntu@ubuntu:/tmp/asterisk-1.4.0$ sudo make installyyy123yyysw
make[1]: Nothing to be done for `depend'.yyy123yyysw
make[1]: Nothing to be done for `depend'.yyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
for x in ; do /usr/bin/install -c -m 755 $x /usr/lib/asterisk/modules ; doneyyy123yyysw
make[1]: Leaving directory `/tmp/asterisk-1.4.0/main'yyy123yyysw
 +---- Asterisk Installation Complete -------+yyy123yyysw
 +                                           +yyy123yyysw
 +    YOU MUST READ THE SECURITY DOCUMENT    +yyy123yyysw
 +                                           +yyy123yyysw
 + Asterisk has successfully been installed. +yyy123yyysw
 + If you would like to install the sample   +yyy123yyysw
 + configuration files (overwriting any      +yyy123yyysw
 + existing config files), run:              +yyy123yyysw
 +                                           +yyy123yyysw
 +               make samples                +yyy123yyysw
 +                                           +yyy123yyysw
 +-----------------  or ---------------------+yyy123yyysw
 +                                           +yyy123yyysw
 + You can go ahead and install the asterisk +yyy123yyysw
 + program documentation now or later run:   +yyy123yyysw
 +                                           +yyy123yyysw
 +              make progdocs                +yyy123yyysw
 +                                           +yyy123yyysw
 + **Note** This requires that you have      +yyy123yyysw
 + doxygen installed on your local system    +yyy123yyysw
 +-------------------------------------------+yyy123yyysw
ubuntu@ubuntu:/tmp/asterisk-1.4.0$ yyy123yyysw</screen>

  <para>Die eben kompilierten Programmdateien sind jetzt auf dem System
  installiert. Allerdings finden wir im Asterisk-Konfigurationsverzeichnis
  <filename>/etc/asterisk/</filename> noch gähnende Leere vor. In diesem
  Verzeichnis liegen die Konfigurationsdateien von Asterisk und da wir nicht
  von Null beginnen möchten, lassen wir uns die Standarddateien erstellen.
  Dies erreichen wir mit einem <command>sudo make samples</command>:</para>

  <screen>ubuntu@ubuntu:/tmp/asterisk-1.4.0$ sudo make samplesyyy123yyysw
mkdir -p /etc/asteriskyyy123yyysw
for x in configs/*.adsi; do \yyy123yyysw
                if [ ! -f /etc/asterisk/$x ]; then \yyy123yyysw
                        /usr/bin/install -c -m 644 $x /etc/asterisk/`/usr/bin/basename $x` ; \yyy123yyysw
                fi ; \yyy123yyysw
yyy123yyysw
yyy123yyysw
[...]yyy123yyysw
yyy123yyysw
for x in vm-theperson digits/1 digits/2 digits/3 digits/4 vm-isonphone; do \yyy123yyysw
                cat /var/lib/asterisk/sounds/$x.gsm &gt;&gt; /var/spool/asterisk/voicemail/default/1234/busy.gsm ; \yyy123yyysw
        doneyyy123yyysw
ubuntu@ubuntu:/tmp/asterisk-1.4.0$ yyy123yyysw</screen>

  <para>Fertig! Asterisk ist auf Ihrem System installiert. Mit dem Befehl
  <command>sudo asterisk -V</command> können Sie die installierte Version
  rausfinden (bitte achten Sie auf das großgeschriebene V):<screen>ubuntu@ubuntu:/tmp/asterisk-1.4.0$ sudo asterisk -Vyyy123yyysw
Asterisk 1.4.0yyy123yyysw
ubuntu@ubuntu:/tmp/asterisk-1.4.0$yyy123yyysw</screen></para>
</section>