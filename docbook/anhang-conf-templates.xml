<?xml version="1.0" encoding="ISO-8859-1"?>
<appendix id="anhang-conf-templates">
  <title>Konfigurations-Templates<indexterm>
      <primary>config templates</primary>
    </indexterm><indexterm>
      <primary>Konfigurations-Templates</primary>
    </indexterm></title>

  <simpara>Konfigurationsdateien wie die <filename>sip.conf</filename>,
  <filename>iax.conf</filename> etc. haben oft viele ähnliche Einträge und
  sind dadurch schlecht wartbar.</simpara>

  <para>Das könnte in einer normalen <filename>sip.conf</filename>
  stehen:<programlisting>[201]yyy123yyysw
username=201yyy123yyysw
secret=1111yyy123yyysw
context=defaultyyy123yyysw
type=friendyyy123yyysw
qualify=yesyyy123yyysw
host=dynamicyyy123yyysw
canreinvite=noyyy123yyysw
yyy123yyysw
[202]yyy123yyysw
username=202yyy123yyysw
secret=2222yyy123yyysw
context=defaultyyy123yyysw
type=friendyyy123yyysw
qualify=yesyyy123yyysw
host=dynamicyyy123yyysw
canreinvite=noyyy123yyysw
yyy123yyysw
[203]yyy123yyysw
username=203yyy123yyysw
secret=3333yyy123yyysw
context=defaultyyy123yyysw
type=friendyyy123yyysw
qualify=yesyyy123yyysw
host=dynamicyyy123yyysw
canreinvite=noyyy123yyysw</programlisting></para>

  <para>Asterisk bietet aber die kaum bekannte Möglichkeit, hierfür Templates
  zu verwenden. Mit einem Template für unsere Telefone sähe das so
  aus:<programlisting>[meine-telefone](!)       ; dieser Abschnitt ist das Templateyyy123yyysw
context=defaultyyy123yyysw
type=friendyyy123yyysw
qualify=yesyyy123yyysw
host=dynamicyyy123yyysw
canreinvite=noyyy123yyysw
yyy123yyysw
[201](meine-telefone)     ; Telefon 201yyy123yyysw
username=201yyy123yyysw
secret=1111yyy123yyysw
yyy123yyysw
[202](meine-telefone)     ; Telefon 202yyy123yyysw
username=202yyy123yyysw
secret=2222yyy123yyysw
yyy123yyysw
[203](meine-telefone)     ; Telefon 203yyy123yyysw
username=203yyy123yyysw
secret=3333yyy123yyysw</programlisting></para>

  <simpara>Das ist besonders interssant, wenn man verschiedene Gruppen oder
  Klassen von sehr ähnlichen Einträgen hat, also nicht die Möglichkeit
  besteht, einfach alle Gemeinsamkeiten in den Abschnitt
  <code>[general]</code> zu schreiben. Schon in diesem einfachen Beispiel
  haben wir und ein paar Zeilen gespart und können vor allem Veränderungen für
  alle Telefone der <quote>Klasse</quote> <code>meine-telefone</code> an
  zentraler Stelle vornehmen.</simpara>

  <section id="conf-templates-anlegen">
    <title>Templates anlegen</title>

    <para>Prinzipiell kann jeder Abschnitt als Template für andere dienen,
    aber mit der Markierung <code>(!)</code> zeigt man dem Parser an, dass
    dieser Abschnitt <emphasis>ausschließlich</emphasis> als Template dient
    und selbst nicht benutzt wird. Wichtig ist, dass zwischen den eckigen und
    runden Klammern keine Leerzeichen stehen. Templates können auch selbst
    wieder auf Templates basieren.<programlisting>[meine-beispiel-template](!)yyy123yyysw
context=defaultyyy123yyysw
type=friendyyy123yyysw
qualify=yesyyy123yyysw
host=dynamicyyy123yyysw
canreinvite=noyyy123yyysw</programlisting></para>
  </section>

  <section id="conf-templates-verwenden">
    <title>Templates verwenden</title>

    <para>Templates verwendet man durch Angabe von
    <code>(<replaceable>Templatename</replaceable>)</code> direkt - ohne
    Leerzeichen! - hinter dem Abschnittsbeginn. Dadurch wird zuerst das
    angegebene Template eingebunden und dann die weiteren Parameter in dem
    Abschnitt ausgewertet. Abschnitte können sogar von mehreren Templates
    erben, z.B. so:<programlisting>[201](meine-telefone,verkauf)   ; erbt von "meine-telefone" und von "verkauf"yyy123yyysw
username=201yyy123yyysw
secret=1111yyy123yyysw</programlisting>Bei Bedarf kann man pro Abschnitt die
    Einstellungen aus dem Template überschreiben.</para>

    <section id="conf-templates-beispiel">
      <title>Beispiel</title>

      <para><programlisting>[telefone](!)               ; Template "telefone"yyy123yyysw
type=friendyyy123yyysw
qualify=yesyyy123yyysw
dtmfmode=rfc2833yyy123yyysw
disallow=allyyy123yyysw
allow=alawyyy123yyysw
yyy123yyysw
[snom](!,telefone)          ; Template "snom", erbt von "telefone"yyy123yyysw
dtmfmode=inbandyyy123yyysw
yyy123yyysw
[linksys](!,telefone)       ; Template "linksys", erbt von "telefone"yyy123yyysw
qualify=noyyy123yyysw
yyy123yyysw
[snom1](snom)               ; Abschnitt "snom1", erbt von "snom"yyy123yyysw
username=101yyy123yyysw
secret=123yyy123yyysw
yyy123yyysw
[snom2](snom)               ; Abschnitt "snom2", erbt von "snom"yyy123yyysw
username=102yyy123yyysw
secret=123yyy123yyysw
yyy123yyysw
[linksys1](linksys)         ; Abschnitt "linksys1", erbt von "linksys"yyy123yyysw
username=103yyy123yyysw
secret=123yyy123yyysw</programlisting></para>

      <para>Weitere Beispiele: <ulink
      url="http://www.voip-info.org/wiki/index.php?page=Asterisk+config+template">http://www.voip-info.org/wiki/index.php?page=Asterisk+config+template</ulink></para>
    </section>
  </section>
</appendix>