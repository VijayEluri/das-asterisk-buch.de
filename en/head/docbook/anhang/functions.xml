<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE appendix PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<appendix id="functions" lang="en" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% translated from the German by Stephen Bosch <sbosch@vodacomm.ca>
% Asterisk training and consulting is offered at http://www.amooma.de
-->

  <title>Functions in the dialplan</title>

  <simpara>In addition to dialplan applications, which have been part of
  Asterisk almost from the very beginning, Asterisk also supports functions as
  of Asterisk 1.2. This is part of a long-standing effort to make Asterisk
  behave more like a programming environment. In contrast to applications,
  functions may not be called directly. Instead, they are called inside
  applications and return a value, or -- in a departure from the classical
  definition of a function -- they may even be written to using the
  application <command><code>Set()</code></command> (see <xref
  linkend="applications-set" />). Function names are always written in
  uppercase letters. Surprisingly, functions are written in the same way as
  variables, inside curly braces and preceded by a $ character (
  <code>${}</code> ). This is necessary because strings are not always bounded
  by quotation marks.</simpara>

  <sidebar>
    <simpara>We could be forgiven for criticizing the less-than-intuitive
    distinction between Asterisk applications, functions and even variables.
    Nor is there a consistently applied naming convention: for example,
    <code>SIP_HEADER()</code> is broken by an underscore ("_") but
    <code>SIPCHANINFO()</code> is not. This is a problem with many programming
    languages and environments; these differences in convention add no useful
    information but make learning more difficult. In addition to this, the use
    of the delimiters <code>,</code> ("comma"), <code>&amp;</code>
    ("ampersand") and <code>|</code> ("pipe") appears arbitrary. The concept
    of writing to a function in the same way one might write to a variable
    goes counter to the basic definition of a function in nearly every other
    programming language and continues to cause confusion, particularly among
    new Asterisk users with programming backgrounds.</simpara>

    <para>A better way to imagine a function in Asterisk is as an associative
    array<footnote>
        <para><ulink
        url="http://de.wikipedia.org/wiki/Assoziatives_Array">http://en.wikipedia.org/wiki/Associative_array</ulink></para>
      </footnote> (a hash table is a form of associative array). For
    example:<programlisting>Set(CHANNEL(language)=de);
NoOp(Language: ${CHANNEL(language)});</programlisting>would look like this in
    PHP:<programlisting>$channel["language"] = "de";
echo "Language: ", $channel["language"];</programlisting></para>

    <para>Many functions allow the key in our associative array analogy to be
    empty. For example:<programlisting>Set(GROUP()=outgoing);</programlisting></para>

    <simpara>Despite considerable improvements in Version 1.4, the dialplan
    programming remains rather inflexible when compared with "real"
    programming languages. If this proves bothersome, you might consider
    exploring Asterisk Extension Language (AEL) in more depth (see <xref
    linkend="ael" />) as it uses the same functions and applications but has a
    more robust structure and is often easier to interpret.</simpara>
  </sidebar>

  <simpara>To find out which functions are currently available in your
  installation, enter <userinput>core show functions</userinput> and
  <userinput>core show function
  <replaceable>FUNCTIONNAME</replaceable></userinput> (or <userinput>show
  functions</userinput> and <userinput>show function
  <replaceable>FUNCTIONNAME</replaceable></userinput> for Asterisk 1.2) in the
  CLI.<footnote>
      <para>Command Line Interface. This may be invoked with <command>asterisk
      -r</command>.</para>
    </footnote>Note that these commands are case-sensitive. Function names
  must be written entirely in uppercase letters.</simpara>

  <xi:include href="functions/agent.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/array.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/base64_decode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/base64_encode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/callerid.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/cdr.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/channel.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/checksipdomain.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/curl.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/cut.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/db.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/db_delete.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/db_exists.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/dundilookup.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/enumlookup.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/env.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/eval.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/exists.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/fieldqty.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/filter.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/global.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group_list.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/group_match_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/iaxpeer.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/if.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/iftime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/isnull.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/keypadhash.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/language.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/len.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/math.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/md5.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/musicclass.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_sql.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/odbc_user_database.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queueagentcount.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_member_count.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/queue_member_list.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/quote.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/rand.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/regex.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/set.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sha1.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sipchaninfo.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sippeer.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sip_header.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/sort.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/stat.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/strftime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/strptime.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/timeout.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/txtcidname.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/uridecode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/uriencode.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />

  <xi:include href="functions/vmcount.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude" />
</appendix>
