<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="functions-cdr" lang="en" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>CDR()</literal><indexterm significance="preferred">
        <primary>Dialplan Functions</primary>

        <secondary><code>CDR()</code></secondary>
      </indexterm></title>

    <synopsis>CDR(<replaceable>field</replaceable>)</synopsis>

    <para>Reads or sets CDR<footnote>
        <simpara>Call Data Record, siehe <xref
        linkend="glossar-cdr" /></simpara>
      </footnote> fields. The <replaceable>field</replaceable> is one of the
    following (only reading is possible unless otherwise noted):<variablelist
        termlength="13">
        <varlistentry>
          <term><code>clid</code></term>

          <listitem>
            <simpara>Caller ID</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>src</code></term>

          <listitem>
            <simpara>The source number (caller ID number)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>dst</code></term>

          <listitem>
            <simpara>The call destination</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>dcontext</code></term>

          <listitem>
            <simpara>Destination context</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>channel</code></term>

          <listitem>
            <simpara>Channel name</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>dstchannel</code></term>

          <listitem>
            <simpara>Destination channel, if applicable</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>lastapp</code></term>

          <listitem>
            <simpara>The last executed application</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>lastdata</code></term>

          <listitem>
            <simpara>The arguments to the last executed application</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>start</code></term>

          <listitem>
            <simpara>Time the call started</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>answer</code></term>

          <listitem>
            <simpara>Time the call was answered</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>end</code></term>

          <listitem>
            <simpara>Time the call ended</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>duration</code></term>

          <listitem>
            <simpara>Duration of the call in seconds</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>billsec</code></term>

          <listitem>
            <simpara>Duration of the call since the call was answered (in
            other words, the billable duration) in seconds</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>disposition</code></term>

          <listitem>
            <simpara>Status of the call: <code>ANSWERED</code>, <code>NO
            ANSWER</code>, <code>BUSY</code> or <code>FAILED</code></simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>amaflags</code></term>

          <listitem>
            <simpara>The AMA<footnote>
                <simpara>Automated Message Accounting, see <xref
                linkend="glossar-AMA" /></simpara>
              </footnote> flags. Possible flags are <code>DEFAULT</code>,
            <code>BILLING</code>, <code>DOCUMENTATION</code> and
            <code>OMIT</code>. (Sometimes <code>BILLING</code> and
            <code>OMIT</code> are replaced by <code>BILL</code> and
            <code>IGNORE</code>, perhaps depending on the Asterisk
            version.)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>accountcode</code></term>

          <listitem>
            <simpara>The alphanumeric ID of the billing account, maximum 20
            characters. May be set as well as read</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>uniqueid</code></term>

          <listitem>
            <simpara>The unique ID of the channel (maximum 32
            characters)</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>userfield</code></term>

          <listitem>
            <simpara>A user field for storing arbitrary information (maximum
            255 characters). May be set as well as read</simpara>
          </listitem>
        </varlistentry>
      </variablelist><programlisting>; Set foo to the duration of the call:
exten =&gt; 123,1,Set(foo=${CDR(duration)})

; Set the user field to "my information":
exten =&gt; 123,1,Set(CDR(userfield)=my information)</programlisting></para>

    <note>
      <formalpara>
        <title>Internal help for this application in Asterisk 1.4:</title>

        <para><screen>  -= Info about function 'CDR' =- 

[Syntax]
  Here is a list of all the available cdr field names:
    clid          lastdata       disposition
    src           start          amaflags
    dst           answer         accountcode
    dcontext      end            uniqueid
    dstchannel    duration       userfield
    lastapp       billsec        channel
  All of the above variables are read-only, except for accountcode,
  userfield, and amaflags. You may, however,  supply
  a name not on the above list, and create your own
  variable, whose value can be changed with this function,
  and this variable will be stored on the cdr.
   raw values for disposition:
       1 = NO ANSWER
       2 = BUSY
       3 = FAILED
       4 = ANSWERED
    raw values for amaflags:
       1 = OMIT
       2 = BILLING
       3 = DOCUMENTATION


[Synopsis]
Gets or sets a CDR variable

[Description]
Options:
  'r' searches the entire stack of CDRs on the channel
  'u' retrieves the raw, unprocessed value
  For example, 'start', 'answer', and 'end' will be retrieved as epoch
  values, when the 'u' option is passed, but formatted as YYYY-MM-DD HH:MM:SS
  otherwise.  Similarly, disposition and amaflags will return their raw
  integral values.</screen></para>
      </formalpara>

      <formalpara>
        <title>diff output to internal help in Asterisk 1.2:</title>

        <para><screen>5,26c5
&lt;   Here is a list of all the available cdr field names:
&lt;     clid          lastdata       disposition
&lt;     src           start          amaflags
&lt;     dst           answer         accountcode
&lt;     dcontext      end            uniqueid
&lt;     dstchannel    duration       userfield
&lt;     lastapp       billsec        channel
&lt;   All of the above variables are read-only, except for accountcode,
&lt;   userfield, and amaflags. You may, however,  supply
&lt;   a name not on the above list, and create your own
&lt;   variable, whose value can be changed with this function,
&lt;   and this variable will be stored on the cdr.
&lt;    raw values for disposition:
&lt;        1 = NO ANSWER
&lt;        2 = BUSY
&lt;        3 = FAILED
&lt;        4 = ANSWERED
&lt;     raw values for amaflags:
&lt;        1 = OMIT
&lt;        2 = BILLING
&lt;        3 = DOCUMENTATION
&lt; 
---
&gt; CDR(&lt;name&gt;[|options])
32,38c11
&lt; Options:
&lt;   'r' searches the entire stack of CDRs on the channel
&lt;   'u' retrieves the raw, unprocessed value
&lt;   For example, 'start', 'answer', and 'end' will be retrieved as epoch
&lt;   values, when the 'u' option is passed, but formatted as YYYY-MM-DD HH:MM:SS
&lt;   otherwise.  Similarly, disposition and amaflags will return their raw
&lt;   integral values.
---
&gt; Option 'r' searches the entire stack of CDRs on the channel</screen></para>
      </formalpara>
    </note>
</section>
