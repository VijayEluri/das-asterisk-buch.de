<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="applications-record" lang="en" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>Record()</literal></title>

    <indexterm significance="preferred">
      <primary>Dialplan Applications</primary>

      <secondary><code>Record()</code></secondary>
    </indexterm>

    <simpara>Records audio from a channel to a file.</simpara>

    <para>as of Asterisk 1.2: <synopsis><command>Record(<replaceable>basename</replaceable>[.<replaceable>format</replaceable>[,<replaceable>maxSilence</replaceable>[,<replaceable>maxDuration</replaceable>[,<replaceable>options</replaceable>]]]])</command></synopsis></para>

    <simpara>Records audio from the channel and saves it in the file
    base<filename>name.format</filename>. If the file exists, it is
    overwritten.</simpara>

    <para>Allowed options are: <variablelist termlength="10">
        <varlistentry>
          <term><code>format</code></term>

          <listitem>
            <simpara>Specifies the file format of the recording
            (<code>g723</code>, <code>g729</code>, <code>gsm</code>,
            <code>h263</code>, <code>ulaw</code>, <code>alaw</code>,
            <code>wav</code>, ...).</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>maxSilence</code></term>

          <listitem>
            <simpara>Defines the maximum duration of silence allowed before
            the recording is ended.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>maxDuration</code></term>

          <listitem>
            <simpara>Defines the maximum duration of the recording. If not
            provided or if 0, there is no limit.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>options</code></term>

          <listitem>
            <para>One or more of the following option flags may be set:
            <variablelist termlength="3">
                <varlistentry>
                  <term><code>s</code></term>

                  <listitem>
                    <simpara>Does not record if the call has not been
                    answered.</simpara>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><code>n</code></term>

                  <listitem>
                    <simpara>Does not answer but records even if the call has
                    not been answered.</simpara>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><code>a</code></term>

                  <listitem>
                    <simpara>Appends the recording to an existing file instead
                    of overwriting it.</simpara>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><code>t</code></term>

                  <listitem>
                    <simpara>The <code>"*"</code> DTMF key ends the call
                    instead of the default "<code>#"</code> key.</simpara>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><code>q</code></term>

                  <listitem>
                    <simpara>Does not play a beep tone before
                    recording.</simpara>
                  </listitem>
                </varlistentry>

                <varlistentry>
                  <term><code>x</code></term>

                  <listitem>
                    <simpara>Records all DTMF tones, including
                    <code>"#"</code> and "<code>*"</code>. The call ends when
                    <replaceable>maxDuration</replaceable> is reached or the
                    caller hangs up.</simpara>
                  </listitem>
                </varlistentry>
              </variablelist></para>
          </listitem>
        </varlistentry>
      </variablelist></para>

    <simpara>If <code>basename</code> contains <code>%d</code>, it is replaced
    by a number incremented by 1 for each new recording.</simpara>

    <simpara>The caller may end recording by pressing the "<code>#</code>"
    key; if the caller hangs up before recording is complete, the recording is
    discarded.</simpara>

    <simpara>Returns -1 on hang-up, otherwise returns 0.</simpara>

    <programlisting>; Record the caller's name:
exten =&gt; 123,1,Playback(please-say-your-name)
exten =&gt; 123,n,Record(/tmp/name.gsm,3,10)
exten =&gt; 123,n,Playback(/tmp/name)</programlisting>

    <simpara>Note the warnings regarding privacy under
    <code><command>Monitor()</command></code>.</simpara>

    <note>
      <formalpara>
        <title>Internal help for this application in Asterisk 1.4:</title>

        <para><screen>  -= Info about application 'Record' =- 

[Synopsis]
Record to a file

[Description]
  Record(filename.format|silence[|maxduration][|options])

Records from the channel into a given filename. If the file exists it will
be overwritten.
- 'format' is the format of the file type to be recorded (wav, gsm, etc).
- 'silence' is the number of seconds of silence to allow before returning.
- 'maxduration' is the maximum recording duration in seconds. If missing
or 0 there is no maximum.
- 'options' may contain any of the following letters:
     'a' : append to existing recording rather than replacing
     'n' : do not answer, but record anyway if line not yet answered
     'q' : quiet (do not play a beep tone)
     's' : skip recording if the line is not yet answered
     't' : use alternate '*' terminator key (DTMF) instead of default '#'
     'x' : ignore all terminator keys (DTMF) and keep recording until hangup

If filename contains '%d', these characters will be replaced with a number
incremented by one each time the file is recorded. 

Use 'show file formats' to see the available formats on your system

User can press '#' to terminate the recording and continue to the next priority.

If the user should hangup during a recording, all data will be lost and the
application will teminate.</screen></para>
      </formalpara>

      <formalpara>
        <title>diff output to internal help in Asterisk 1.2:</title>

        <para><screen>21,22c21
&lt;      't' : use alternate '*' terminator key (DTMF) instead of default '#'
&lt;      'x' : ignore all terminator keys (DTMF) and keep recording until hangup
---
&gt;      't' : use alternate '*' terminator key instead of default '#'</screen></para>
      </formalpara>
    </note>

    <formalpara>
      <title>See also</title>

      <para><xref linkend="applications-dictate" />, <xref
      linkend="applications-monitor" />, <xref
      linkend="applications-mixmonitor" /></para>
    </formalpara>
</section>
