<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="applications-callingpres" lang="en" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>CallingPres()</literal></title>

    <indexterm significance="preferred">
      <primary>Dialplan Applications</primary>

      <secondary><code>CallingPres()</code></secondary>
    </indexterm>

    <remark>FIXME NEEDSTRANSLATION - was modified in de</remark>

    <simpara>Changes the caller ID on an ISDN-PRI channel.</simpara>

    <synopsis><command>CallingPres(<replaceable>presentation</replaceable>)</command></synopsis>

    <simpara>Changes the presentation parameter in the caller ID for calls
    using Q.931 PRI connections. These parameters should be set before the
    call is initiated. The presentation parameter
    <emphasis>presentation</emphasis> defines first whether the called party
    will be sent caller ID information in the first place, and second, whether
    it was verified against a reliable source (screening).</simpara>

    <simpara>This application has been superceded by
    <code>SetCallerPres()</code>, which is easier to use and less dependent on
    Zaptel.</simpara>

    <simpara>This application generates a number based on the presentation and
    screening settings. The meaning of the values themselves is defined in the
    ITU Q.931-Standard as described in the following tables.</simpara>

    <para>Screening is set by bits 1 and 2:<informaltable colsep="0"
        frame="none" rowsep="0">
        <tgroup cols="3">
          <colspec colnum="1" colwidth="30pt" />

          <colspec colnum="2" colwidth="30pt" />

          <thead>
            <row>
              <entry>Bit1</entry>

              <entry>Bit2</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>0</entry>

              <entry>0</entry>

              <entry>The caller ID information was provided by the endpoint
              and no verification was attempted.</entry>
            </row>

            <row>
              <entry>0</entry>

              <entry>1</entry>

              <entry>The caller ID information was provided by the endpoint
              and was successfully verified.</entry>
            </row>

            <row>
              <entry>1</entry>

              <entry>0</entry>

              <entry>The caller ID information was provided by the endpoint
              but verification was unsuccessful.</entry>
            </row>

            <row>
              <entry>1</entry>

              <entry>1</entry>

              <entry>The caller ID information was provided by the
              network.</entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable></para>

    <para>Presentation is set by bits 6 and 7:<informaltable colsep="0"
        frame="none" rowsep="0">
        <tgroup cols="3">
          <colspec colnum="1" colwidth="30pt" />

          <colspec colnum="2" colwidth="30pt" />

          <thead>
            <row>
              <entry>Bit6</entry>

              <entry>Bit7</entry>

              <entry>Description</entry>
            </row>
          </thead>

          <tbody>
            <row>
              <entry>0</entry>

              <entry>0</entry>

              <entry>Display of caller ID is allowed.</entry>
            </row>

            <row>
              <entry>0</entry>

              <entry>1</entry>

              <entry>Display of caller ID is not allowed.</entry>
            </row>

            <row>
              <entry>1</entry>

              <entry>0</entry>

              <entry>The number is not available because it was not passed by
              an intermediate station.</entry>
            </row>

            <row>
              <entry>1</entry>

              <entry>1</entry>

              <entry>Reserved</entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable></para>

    <simpara>The bits 3, 4, 5 and 8 should be zero (0). Note that the bits are
    numbered in descending order, <emphasis>i.e.</emphasis>
    87654321.</simpara>

    <programlisting>; set presentation to:
; presentation allowed                                                    (00000000)
; provided by the network                                                 (00000011)
; ------------------                                                      ----------
; Result: 3 (bitwise AND)                                                 (00000011)
exten =&gt; 123,1,CallingPres(3)
exten =&gt; 123,2,Dial(Zap/g1/1234567)
; set presentation to:
; presentation restricted, blocked by intermediate station                (00100000)
; user provided ID, verified                                              (00000001)
; ------------------                                                      ----------
; Ergebnis: 33 (bitwise AND)          (00100001)
exten =&gt; 124,1,CallingPres(33)
exten =&gt; 124,2,Dial(Zap/g1/1234568)</programlisting>

    <formalpara>
      <title>See also</title>

      <para><xref linkend="applications-setcallerpres" /></para>
    </formalpara>
</section>
