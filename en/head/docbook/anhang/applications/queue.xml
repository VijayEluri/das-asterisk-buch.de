<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="applications-queue" lang="en" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>Queue()</literal></title>

    <indexterm significance="preferred">
      <primary>Dialplan Applications</primary>

      <secondary><code>Queue()</code></secondary>
    </indexterm>

    <simpara>Places a call in the specified queue.</simpara>

    <synopsis><command>Queue(<replaceable>queue</replaceable>[,<replaceable>options</replaceable>[,<replaceable>URL</replaceable>[,<replaceable>announcement</replaceable>[,<replaceable>timeout</replaceable>[,<replaceable>AGI</replaceable>]]]]])</command></synopsis>

    <simpara>Passes an incoming call into the specified queue (predefined in
    <filename>queues.conf</filename>).</simpara>

    <para>The following options are available and may be combined:
    <variablelist termlength="3">
        <varlistentry>
          <term><code>t</code></term>

          <listitem>
            <simpara>Allow the called party to transfer the call.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>T</code></term>

          <listitem>
            <simpara>Allow the calling party to transfer the call.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>d</code></term>

          <listitem>
            <simpara>Data-quality (modem) call (minimizes delay).</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>h</code></term>

          <listitem>
            <simpara>Called party may end the call by pressing "*".</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>H</code></term>

          <listitem>
            <simpara>Calling party may end the call by pressing "*".</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>n</code></term>

          <listitem>
            <simpara>No retries on timeout; proceeds to the next
            priority.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><code>r</code></term>

          <listitem>
            <simpara>Rings instead of playing music-on-hold.</simpara>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>i</term>

          <listitem>
            <para>Ignore call forward requests from queue members; instead do
            nothing.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>w</term>

          <listitem>
            <para>Allow the called party to record the conversation via
            <command>Monitor()</command>.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>W</term>

          <listitem>
            <para>Allow the calling party to record the conversation via
            <command>Monitor()</command>.</para>
          </listitem>
        </varlistentry>
      </variablelist></para>

    <simpara>If a call is transferable, it may also be parked and retrieved by
    another user.</simpara>

    <simpara>The argument <replaceable>announcement</replaceable> specifies a
    wait announcement to be played back to the caller at intervals until a
    queue member answers the call; the default announcement, if there is one,
    is defined in <filename>queues.conf</filename>.</simpara>

    <simpara>The optional <code>URL</code> is sent to the caller if the the
    calling channel supports it. This could be used on compatible SIP phones
    to provide queue information to the phone's display panel.</simpara>

    <simpara>The <replaceable>timeout</replaceable> argument causes the call
    to fail out of the queue after <replaceable>timeout</replaceable> number
    of seconds. The default is 300 seconds (or 5 minutes).</simpara>

    <simpara>Returns -1 if the originating channel is hung up or if the call
    is connected to a queue member and ended by one of the parties. If the
    queue is full, does not exist, or has no member, returns 0; execution
    continues in the next priority in the dialplan.</simpara>

    <programlisting>; pass the caller to the support queue:
exten =&gt; 123,1,Answer()
exten =&gt; 123,n,Queue(support,t)</programlisting>

    <note>
      <formalpara>
        <title>Internal help for this application in Asterisk 1.4:</title>

        <para><screen>  -= Info about application 'Queue' =- 

[Synopsis]
Queue a call for a call queue

[Description]
  Queue(queuename[|options[|URL][|announceoverride][|timeout][|AGI]):
Queues an incoming call in a particular call queue as defined in queues.conf.
This application will return to the dialplan if the queue does not exist, or
any of the join options cause the caller to not enter the queue.
The option string may contain zero or more of the following characters:
      'd' -- data-quality (modem) call (minimum delay).
      'h' -- allow callee to hang up by hitting *.
      'H' -- allow caller to hang up by hitting *.
      'n' -- no retries on the timeout; will exit this application and 
             go to the next step.
      'i' -- ignore call forward requests from queue members and do nothing
             when they are requested.
      'r' -- ring instead of playing MOH
      't' -- allow the called user transfer the calling user
      'T' -- to allow the calling user to transfer the call.
      'w' -- allow the called user to write the conversation to disk via Monitor
      'W' -- allow the calling user to write the conversation to disk via Monitor
  In addition to transferring the call, a call may be parked and then picked
up by another user.
  The optional URL will be sent to the called party if the channel supports
it.
  The optional AGI parameter will setup an AGI script to be executed on the 
calling party's channel once they are connected to a queue member.
  The timeout will cause the queue to fail out after a specified number of
seconds, checked between each queues.conf 'timeout' and 'retry' cycle.
  This application sets the following channel variable upon completion:
      QUEUESTATUS    The status of the call as a text string, one of
             TIMEOUT | FULL | JOINEMPTY | LEAVEEMPTY | JOINUNAVAIL | LEAVEUNAVAIL</screen></para>
      </formalpara>

      <formalpara>
        <title>diff output to internal help in Asterisk 1.2:</title>

        <para><screen>8c8
&lt;   Queue(queuename[|options[|URL][|announceoverride][|timeout][|AGI]):
---
&gt;   Queue(queuename[|options[|URL][|announceoverride][|timeout]]):
17,19c17
&lt;              go to the next step.
&lt;       'i' -- ignore call forward requests from queue members and do nothing
&lt;              when they are requested.
---
&gt;        go to the next step.
29,30d26
&lt;   The optional AGI parameter will setup an AGI script to be executed on the 
&lt; calling party's channel once they are connected to a queue member.</screen></para>
      </formalpara>
    </note>

    <formalpara>
      <title>See also</title>

      <para><xref linkend="applications-queuelog" />, <xref
      linkend="warteschleifen" /></para>
    </formalpara>
</section>
