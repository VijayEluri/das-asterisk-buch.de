<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
"http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd">
<section id="applications-voicemail" lang="en" revision="$Revision$">
  <!--
% Copyright (c) 2006 - 2008 by 
% Stefan Wintermeyer <stefan.wintermeyer@amooma.de>
% Philipp Kempgen <philipp.kempgen@amooma.de>
% Permission is granted to copy, distribute and/or modify this document
% under the terms of the GNU Free Documentation License, Version 1.2
% or any later version published by the Free Software Foundation
% with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
% Texts. A copy of the license is included in the section entitled "GNU
% Free Documentation License".
% Asterisk training and consulting is offered at http://www.amooma.de
-->

    <title><literal>VoiceMail()</literal></title>

    <indexterm significance="preferred">
      <primary>Dialplan Applications</primary>

      <secondary><code>VoiceMail()</code></secondary>
    </indexterm>

    <simpara>Allows the caller to leave a voice mail message in the specified
    mailbox.</simpara>

    <synopsis><command>VoiceMail(<replaceable>mailbox</replaceable>[@<replaceable>context</replaceable>][&amp;<replaceable>mailbox</replaceable>[@<replaceable>context</replaceable>][&amp;<replaceable>...</replaceable>]],<replaceable>options</replaceable>)</command></synopsis>

    <para>old syntax:<synopsis><command>VoiceMail([s|u|b]<replaceable>mailbox</replaceable>[@<replaceable>context</replaceable>][&amp;<replaceable>mailbox</replaceable>[@<replaceable>context</replaceable>][&amp;<replaceable>...</replaceable>]])</command></synopsis></para>

    <simpara>Allows the caller to leave a voice mail message in the specified
    mailbox. The mailbox must already be configured in
    <filename>voicemail.conf</filename>. If more than mailbox is listed, the
    greeting from the first mailbox is the one that is played. If the mailbox
    does not exist, dialplan execution ends.</simpara>

    <simpara>The option <code>s</code> (silent) suppresses the prompt. The
    option <code>u</code> plays the "unavailable" message, if it exists. The
    option <code>b</code> plays (busy) message, if it exists (file
    <filename>busy</filename> instead of
    <filename>unavail</filename>).</simpara>

    <warning>
      <para>You cannot mix syntax types. If you do, the application will fail
      as though the mailbox does not exist. We recommend always using the new
      syntax.</para>
    </warning>

    <simpara>If option <code>j</code> is set, jumps to extension
    <replaceable>n</replaceable>+101, if it exists, on failure.</simpara>

    <simpara>If the caller presses <code>0</code> during the prompt, the call
    goes to extension <code>o</code> (small letter "o", for operator) in the
    current context.</simpara>

    <simpara>If the caller presses <code>*</code> during the prompt, the call
    goes to extension <code>a</code> (small letter "a", for assistant) in the
    current context.</simpara>

    <simpara>Returns -1 in case of error (the mailbox could not be found or
    the caller hung up) otherwise returns 0. Sets the channel variable
    <code>VMSTATUS</code> to <code>SUCCESS</code>, <code>USEREXIT</code> (the
    caller cancelled the message) or <code>FAILED</code>.</simpara>

    <programlisting>; send the caller to mailbox 123, play the unavailable message:
exten =&gt; 123,1,VoiceMail(123,u)</programlisting>

    <note>
      <formalpara>
        <title>Internal help for this application in Asterisk 1.4:</title>

        <para><screen>  -= Info about application 'VoiceMail' =- 

[Synopsis]
Leave a Voicemail message

[Description]
  VoiceMail(mailbox[@context][&amp;mailbox[@context]][...][|options]): This
application allows the calling party to leave a message for the specified
list of mailboxes. When multiple mailboxes are specified, the greeting will
be taken from the first mailbox specified. Dialplan execution will stop if the
specified mailbox does not exist.
  The Voicemail application will exit if any of the following DTMF digits are
received:
    0 - Jump to the 'o' extension in the current dialplan context.
    * - Jump to the 'a' extension in the current dialplan context.
  This application will set the following channel variable upon completion:
    VMSTATUS - This indicates the status of the execution of the VoiceMail
               application. The possible values are:
               SUCCESS | USEREXIT | FAILED

  Options:
    b    - Play the 'busy' greeting to the calling party.
    g(#) - Use the specified amount of gain when recording the voicemail
           message. The units are whole-number decibels (dB).
    s    - Skip the playback of instructions for leaving a message to the
           calling party.
    u    - Play the 'unavailble greeting.
    j    - Jump to priority n+101 if the mailbox is not found or some other
           error occurs.</screen></para>
      </formalpara>

      <formalpara>
        <title>diff output to internal help in Asterisk 1.2:</title>

        <para><screen>28c28
&lt;     u    - Play the 'unavailble greeting.
---
&gt;     u    - Play the 'unavailable greeting.</screen></para>
      </formalpara>
    </note>

    <formalpara>
      <title>See also</title>

      <para><xref linkend="applications-voicemailmain" />,
      <filename>voicemail.conf</filename></para>
    </formalpara>
</section>
